<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TrekWanders - Experience The Magic Of Travel!</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f8f9fa;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Header */
        header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            position: fixed;
            top: 0;
            width: 100%;
            z-index: 1000;
            box-shadow: 0 2px 20px rgba(0, 0, 0, 0.1);
        }

        nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 0;
        }

        .logo {
            font-size: 1.8rem;
            font-weight: 700;
            color: #2563eb;
        }

        .nav-links {
            display: flex;
            list-style: none;
            gap: 2rem;
        }

        .nav-links a {
            text-decoration: none;
            color: #333;
            font-weight: 500;
            transition: color 0.3s;
        }

        .nav-links a:hover {
            color: #2563eb;
        }

        .auth-buttons {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .btn {
            padding: 0.7rem 1.5rem;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
            text-decoration: none;
            display: inline-block;
            font-size: 0.9rem;
        }

        .btn-primary {
            background: linear-gradient(135deg, #2563eb, #1d4ed8);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(37, 99, 235, 0.3);
        }

        .btn-outline {
            background: transparent;
            color: #2563eb;
            border: 2px solid #2563eb;
        }

        .btn-outline:hover {
            background: #2563eb;
            color: white;
        }

        .btn-success {
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
        }

        .btn-danger {
            background: linear-gradient(135deg, #ef4444, #dc2626);
            color: white;
        }

        /* Hero Section - Auto-changing Background */
        .hero {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.8) 0%, rgba(118, 75, 162, 0.8) 100%);
            padding: 8rem 0 4rem;
            text-align: center;
            color: white;
            position: relative;
            overflow: hidden;
        }

        .hero-background {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            transition: opacity 1s ease-in-out;
        }

        .hero-background img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            opacity: 0;
            transition: opacity 1s ease-in-out;
        }

        .hero-background img.active {
            opacity: 1;
        }

        .hero-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.8) 0%, rgba(118, 75, 162, 0.8) 100%);
            z-index: 1;
        }

        .hero-content {
            position: relative;
            z-index: 2;
        }

        .hero-text h1 {
            font-size: 3rem;
            font-weight: 700;
            margin-bottom: 1rem;
            line-height: 1.2;
        }

        .hero-text p {
            font-size: 1.2rem;
            margin-bottom: 3rem;
            opacity: 0.9;
        }

        .hero-search {
            background: white;
            border-radius: 50px;
            padding: 1rem;
            margin: 2rem 0;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .search-form {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .search-input {
            flex: 1;
            position: relative;
            display: flex;
            align-items: center;
        }

        .search-input i {
            position: absolute;
            left: 1rem;
            color: #666;
        }

        .search-input input {
            width: 100%;
            padding: 1rem 1rem 1rem 3rem;
            border: none;
            border-radius: 25px;
            font-size: 1rem;
            background: #f8f9fa;
        }

        .search-input input:focus {
            outline: none;
            background: white;
            box-shadow: 0 0 0 2px #2563eb;
        }

        .hero-stats {
            display: flex;
            justify-content: center;
            gap: 3rem;
            margin-top: 3rem;
        }

        .stat-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            color: white;
        }

        .stat-item i {
            font-size: 2rem;
            opacity: 0.8;
        }

        .stat-number {
            font-size: 2rem;
            font-weight: 700;
            display: block;
        }

        .stat-label {
            font-size: 0.9rem;
            opacity: 0.8;
        }

        /* Search Section */
        .search-section {
            background: white;
            padding: 2rem 0;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .search-container {
            display: flex;
            gap: 1rem;
            align-items: center;
            flex-wrap: wrap;
        }

        .search-box {
            flex: 2;
            min-width: 250px;
            position: relative;
        }

        .search-box input {
            width: 100%;
            padding: 1rem 1rem 1rem 3rem;
            border: 2px solid #e5e7eb;
            border-radius: 25px;
            font-size: 1rem;
            transition: border-color 0.3s;
        }

        .search-box input:focus {
            outline: none;
            border-color: #2563eb;
        }

        .search-box i {
            position: absolute;
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
            color: #666;
        }

        .advanced-filters {
            display: flex;
            gap: 1rem;
            align-items: center;
            flex-wrap: wrap;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            min-width: 120px;
        }

        .filter-group label {
            font-size: 0.8rem;
            color: #666;
            font-weight: 500;
        }

        .filter-group select,
        .filter-group input {
            padding: 0.7rem;
            border: 2px solid #e5e7eb;
            border-radius: 15px;
            font-size: 0.9rem;
            transition: border-color 0.3s;
        }

        .filter-group select:focus,
        .filter-group input:focus {
            outline: none;
            border-color: #2563eb;
        }

        .price-range {
            display: flex;
            gap: 0.5rem;
            align-items: center;
        }

        .price-range input {
            width: 80px;
        }

        .category-filter {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        .category-btn {
            padding: 0.5rem 1rem;
            border: 2px solid #e5e7eb;
            background: white;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s;
        }

        .category-btn.active {
            background: #2563eb;
            color: white;
            border-color: #2563eb;
        }

        /* Sections */
        .section {
            padding: 5rem 0;
        }

        .section-title {
            text-align: center;
            margin-bottom: 3rem;
        }

        .section-title h2 {
            font-size: 2.5rem;
            font-weight: 700;
            color: #333;
            margin-bottom: 1rem;
        }

        .section-title p {
            font-size: 1.1rem;
            color: #666;
            max-width: 600px;
            margin: 0 auto;
        }

        /* Trip Cards */
        .trips-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 2rem;
            margin-top: 3rem;
        }

        .trip-card {
            background: white;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s, box-shadow 0.3s;
            cursor: pointer;
            position: relative;
        }

        .trip-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.15);
        }

        .trip-card-image {
            position: relative;
            height: 250px;
            overflow: hidden;
        }

        .trip-card img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s;
        }

        .trip-card:hover img {
            transform: scale(1.1);
        }

        .trip-badge {
            position: absolute;
            top: 15px;
            left: 15px;
            background: rgba(37, 99, 235, 0.9);
            color: white;
            padding: 0.3rem 0.8rem;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: 500;
        }

        .trip-card-content {
            padding: 1.5rem;
        }

        .trip-card h3 {
            font-size: 1.3rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 0.5rem;
        }

        .trip-location {
            color: #666;
            font-size: 0.9rem;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .trip-rating {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .stars {
            color: #ffd700;
        }

        .trip-price {
            font-size: 1.2rem;
            font-weight: 600;
            color: #2563eb;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .trip-duration {
            font-size: 0.8rem;
            color: #666;
            background: #f3f4f6;
            padding: 0.2rem 0.5rem;
            border-radius: 10px;
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background-color: white;
            margin: 2% auto;
            padding: 0;
            border-radius: 20px;
            width: 95%;
            max-width: 1000px;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
        }

        .modal-header {
            position: relative;
            height: 400px;
            overflow: hidden;
            border-radius: 20px 20px 0 0;
        }

        .modal-image-gallery {
            display: flex;
            height: 100%;
            position: relative;
        }

        .modal-image-gallery img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: none;
        }

        .modal-image-gallery img.active {
            display: block;
        }

        .image-nav {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(0, 0, 0, 0.5);
            color: white;
            border: none;
            padding: 1rem;
            cursor: pointer;
            font-size: 1.2rem;
            border-radius: 50%;
        }

        .image-nav.prev {
            left: 20px;
        }

        .image-nav.next {
            right: 20px;
        }

        .image-indicators {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 0.5rem;
        }

        .indicator {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.5);
            cursor: pointer;
            transition: background 0.3s;
        }

        .indicator.active {
            background: white;
        }

        .close {
            position: absolute;
            top: 20px;
            right: 20px;
            color: white;
            font-size: 2rem;
            font-weight: bold;
            cursor: pointer;
            background: rgba(0, 0, 0, 0.5);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10;
        }

        .modal-body {
            padding: 2rem;
        }

        .modal-info {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 2rem;
            margin-bottom: 2rem;
        }

        .trip-details h2 {
            font-size: 2rem;
            color: #333;
            margin-bottom: 1rem;
        }

        .trip-meta {
            display: flex;
            gap: 2rem;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: #666;
        }

        .trip-description {
            color: #666;
            line-height: 1.8;
            margin-bottom: 2rem;
        }

        .requirements {
            background: #f8f9fa;
            padding: 1.5rem;
            border-radius: 15px;
            margin-bottom: 2rem;
        }

        .requirements h4 {
            color: #333;
            margin-bottom: 1rem;
        }

        .requirements ul {
            list-style: none;
            padding: 0;
        }

        .requirements li {
            padding: 0.3rem 0;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .requirements li i {
            color: #10b981;
        }

        .video-container {
            position: relative;
            width: 100%;
            height: 300px;
            margin: 1.5rem 0;
            border-radius: 15px;
            overflow: hidden;
        }

        .video-container iframe {
            width: 100%;
            height: 100%;
            border: none;
        }

        .booking-card {
            background: #f8f9fa;
            padding: 2rem;
            border-radius: 20px;
            position: sticky;
            top: 2rem;
        }

        .price-display {
            text-align: center;
            margin-bottom: 2rem;
        }

        .price-amount {
            font-size: 2.5rem;
            font-weight: 700;
            color: #2563eb;
        }

        .price-per {
            color: #666;
            font-size: 0.9rem;
        }

        .booking-form {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group label {
            font-weight: 500;
            margin-bottom: 0.5rem;
            color: #333;
        }

        .form-group input,
        .form-group textarea,
        .form-group select {
            padding: 0.8rem;
            border: 2px solid #e5e7eb;
            border-radius: 10px;
            font-size: 1rem;
            transition: border-color 0.3s;
        }

        .form-group input:focus,
        .form-group textarea:focus,
        .form-group select:focus {
            outline: none;
            border-color: #2563eb;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }

        .reviews-section {
            margin-top: 3rem;
            padding-top: 2rem;
            border-top: 2px solid #e5e7eb;
        }

        .reviews-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }

        .review-card {
            background: white;
            padding: 1.5rem;
            border-radius: 15px;
            margin-bottom: 1rem;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .review-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .reviewer-info {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .reviewer-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #2563eb;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
        }

        .review-date {
            color: #666;
            font-size: 0.8rem;
        }

        /* Admin Panel */
        .admin-panel {
            background: white;
            border-radius: 20px;
            padding: 2rem;
            margin: 2rem 0;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            display: none;
        }

        .admin-tabs {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            border-bottom: 2px solid #e5e7eb;
        }

        .admin-tab {
            padding: 1rem 2rem;
            border: none;
            background: none;
            cursor: pointer;
            font-weight: 500;
            color: #666;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
        }

        .admin-tab.active {
            color: #2563eb;
            border-bottom-color: #2563eb;
        }

        .admin-content {
            display: none;
        }

        .admin-content.active {
            display: block;
        }

        .admin-form {
            display: grid;
            gap: 1rem;
        }

        .form-group textarea {
            resize: vertical;
            min-height: 100px;
        }

        .image-upload-section {
            border: 2px dashed #e5e7eb;
            padding: 2rem;
            border-radius: 15px;
            text-align: center;
            margin: 1rem 0;
        }

        .image-preview {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }

        .image-preview img {
            width: 100%;
            height: 100px;
            object-fit: cover;
            border-radius: 10px;
        }

        /* Auth Forms */
        .auth-modal {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(5px);
        }

        .auth-form {
            background: white;
            margin: 10% auto;
            padding: 2rem;
            border-radius: 20px;
            width: 90%;
            max-width: 400px;
            position: relative;
        }

        .auth-form h2 {
            text-align: center;
            margin-bottom: 2rem;
            color: #333;
        }

        .user-info {
            display: none;
            align-items: center;
            gap: 1rem;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #2563eb;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
        }

        .role-badge {
            background: #10b981;
            color: white;
            padding: 0.2rem 0.5rem;
            border-radius: 10px;
            font-size: 0.7rem;
            font-weight: 500;
        }

        .role-badge.admin {
            background: #ef4444;
        }

        /* Tab System */
        .tab-buttons {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            justify-content: center;
            flex-wrap: wrap;
        }

        .tab-button {
            padding: 0.8rem 1.5rem;
            border: 2px solid #e5e7eb;
            background: white;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
        }

        .tab-button.active {
            background: #2563eb;
            color: white;
            border-color: #2563eb;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .admin-actions {
            position: absolute;
            top: 10px;
            right: 10px;
            display: flex;
            gap: 0.5rem;
        }

        .admin-btn {
            background: rgba(0, 0, 0, 0.7);
            color: white;
            border: none;
            padding: 0.5rem;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.8rem;
            transition: background 0.3s;
        }

        .admin-btn:hover {
            background: rgba(0, 0, 0, 0.9);
        }

        /* Loading Animation */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #2563eb;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .hero-content {
                grid-template-columns: 1fr;
                text-align: center;
            }

            .hero-text h1 {
                font-size: 2.5rem;
            }

            .nav-links {
                display: none;
            }

            .trips-grid {
                grid-template-columns: 1fr;
            }

            .modal-info {
                grid-template-columns: 1fr;
            }

            .search-container {
                flex-direction: column;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .tab-buttons {
                flex-wrap: wrap;
            }

            .category-filter {
                justify-content: center;
            }
        }

        .hidden {
            display: none !important;
        }

        .success-message {
            background: #10b981;
            color: white;
            padding: 1rem;
            border-radius: 10px;
            margin: 1rem 0;
            text-align: center;
        }

        .error-message {
            background: #ef4444;
            color: white;
            padding: 1rem;
            border-radius: 10px;
            margin: 1rem 0;
            text-align: center;
        }

        /* Feed Section */
        .feed-section {
            background: #f8f9fa;
            padding: 4rem 0;
        }

        /* Material 3 Design - Feed Grid (3 posts per row, 2 rows) */
        .feed-posts-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1.5rem;
            margin-top: 2rem;
            max-height: 600px;
            overflow: hidden;
        }

        .feed-post {
            background: white;
            border-radius: 16px;
            padding: 1.5rem;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            height: fit-content;
            font-size: 0.9rem;
            line-height: 1.4;
            position: relative;
            overflow: hidden;
        }

        .feed-post:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.12);
        }

        /* Material 3 Design - Bookings Grid (4 per row, 2 rows) */
        .bookings-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 1.5rem;
            margin-top: 2rem;
            max-height: 500px;
            overflow: hidden;
        }

        /* Material 3 Design - Booking Cards */
        .booking-card-item {
            background: white;
            border-radius: 16px;
            padding: 1.2rem;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            font-size: 0.85rem;
            line-height: 1.3;
            height: fit-content;
        }

        .booking-card-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.12);
        }

        .booking-card-item:nth-child(n+9) {
            filter: blur(1px);
            opacity: 0.7;
            pointer-events: none;
        }

        .view-more-bookings {
            grid-column: 1 / -1;
            text-align: center;
            margin-top: 1rem;
        }

        /* Material 3 Design - Footer */
        .footer {
            background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
            color: white;
            padding: 3rem 0 1rem;
            margin-top: 4rem;
        }

        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
            margin-bottom: 2rem;
        }

        .footer-section h3, .footer-section h4 {
            margin-bottom: 1rem;
            color: #f1f5f9;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .footer-section p, .footer-section li {
            color: #cbd5e1;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .footer-links {
            list-style: none;
        }

        .footer-links a {
            color: #cbd5e1;
            text-decoration: none;
            transition: color 0.3s;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .footer-links a:hover {
            color: #60a5fa;
        }

        .social-links {
            display: flex;
            gap: 1rem;
        }

        .social-links a {
            width: 40px;
            height: 40px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #cbd5e1;
            text-decoration: none;
            transition: all 0.3s;
        }

        .social-links a:hover {
            background: #60a5fa;
            color: white;
            transform: translateY(-2px);
        }

        .footer-bottom {
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            padding-top: 1rem;
        }

        .footer-bottom-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .footer-bottom-links {
            display: flex;
            gap: 1.5rem;
        }

        .footer-bottom-links a {
            color: #94a3b8;
            text-decoration: none;
            font-size: 0.9rem;
            transition: color 0.3s;
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }

        .footer-bottom-links a:hover {
            color: #60a5fa;
        }

        /* Footer Management Admin Panel */
        .footer-management-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin-top: 1.5rem;
        }

        .contact-management, .social-management {
            background: #f8f9fa;
            padding: 1.5rem;
            border-radius: 12px;
            border: 1px solid #e5e7eb;
        }

        .contact-management h4, .social-management h4 {
            color: #374151;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        /* Load More Button */
        .load-more-btn {
            margin: 2rem auto;
            display: block;
            padding: 1rem 2rem;
            font-size: 1rem;
            border-radius: 25px;
            transition: all 0.3s;
        }

        .load-more-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(37, 99, 235, 0.3);
        }

        /* Material 3 Micro-animations */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(30px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .feed-post, .booking-card-item, .trip-card {
            animation: fadeInUp 0.6s ease-out;
        }

        .feed-post:nth-child(even) {
            animation-delay: 0.1s;
        }

        .feed-post:nth-child(3n) {
            animation-delay: 0.2s;
        }

        .btn:active {
            animation: pulse 0.2s ease-in-out;
        }

        .admin-btn:hover {
            animation: pulse 0.3s ease-in-out infinite;
        }

        .star:hover {
            animation: pulse 0.2s ease-in-out;
            transform: scale(1.2);
        }

        /* Responsive Design for Mobile */
        @media (max-width: 768px) {
            .feed-posts-grid {
                grid-template-columns: 1fr;
                gap: 1rem;
            }
            
            .bookings-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 1rem;
            }
            
            .footer-content {
                grid-template-columns: 1fr;
                text-align: center;
            }
            
            .footer-bottom-content {
                flex-direction: column;
                text-align: center;
            }
        }

        .booking-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 1px solid #e5e7eb;
        }

        .booking-id {
            font-weight: 600;
            color: #2563eb;
            font-size: 0.9rem;
        }

        .booking-status {
            padding: 0.3rem 0.8rem;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: 500;
            text-transform: capitalize;
        }

        .status-pending {
            background: #fef3c7;
            color: #d97706;
        }

        .status-confirmed {
            background: #d1fae5;
            color: #059669;
        }

        .status-cancelled {
            background: #fee2e2;
            color: #dc2626;
        }

        .status-completed {
            background: #dbeafe;
            color: #2563eb;
        }

        .booking-details {
            margin-bottom: 1rem;
        }

        .booking-detail-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
        }

        .booking-actions {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
        }

        .status-selector {
            padding: 0.4rem;
            border: 1px solid #e5e7eb;
            border-radius: 5px;
            font-size: 0.8rem;
            background: white;
        }

        .user-bookings-section {
            background: white;
            border-radius: 20px;
            padding: 2rem;
            margin: 2rem 0;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .smart-suggestions {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 1rem;
            border-radius: 15px;
            margin-bottom: 1rem;
        }

        .suggestion-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            margin: 0.5rem 0;
            cursor: pointer;
            transition: all 0.3s;
        }

        .suggestion-item:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateX(5px);
        }

        .image-upload-section {
            border: 2px dashed #e5e7eb;
            padding: 2rem;
            border-radius: 15px;
            text-align: center;
            margin: 1rem 0;
            background: #f9fafb;
            transition: all 0.3s;
        }

        .image-upload-section:hover {
            border-color: #2563eb;
            background: #f0f7ff;
        }

        .upload-area {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 1rem;
        }

        .upload-btn {
            background: #2563eb;
            color: white;
            border: none;
            padding: 0.8rem 1.5rem;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
        }

        .upload-btn:hover {
            background: #1d4ed8;
            transform: translateY(-2px);
        }

        .hero-image-manager {
            background: white;
            border-radius: 15px;
            padding: 2rem;
            margin: 2rem 0;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .hero-images-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-top: 1rem;
        }

        .hero-image-item {
            position: relative;
            border-radius: 10px;
            overflow: hidden;
            aspect-ratio: 16/9;
        }

        .hero-image-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .hero-image-actions {
            position: absolute;
            top: 5px;
            right: 5px;
            display: flex;
            gap: 0.5rem;
        }

        .hero-image-btn {
            background: rgba(0, 0, 0, 0.7);
            color: white;
            border: none;
            padding: 0.3rem;
            border-radius: 3px;
            cursor: pointer;
            font-size: 0.8rem;
        }

        .post-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .post-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: #2563eb;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 1.2rem;
        }

        .post-info h4 {
            margin: 0;
            color: #333;
        }

        .post-date {
            color: #666;
            font-size: 0.9rem;
        }

        .post-content {
            margin-bottom: 1.5rem;
        }

        .post-image {
            width: 100%;
            max-height: 400px;
            object-fit: cover;
            border-radius: 15px;
            margin: 1rem 0;
        }

        .post-rating {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding-top: 1rem;
            border-top: 1px solid #e5e7eb;
        }

        .rating-section {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .star-rating {
            display: flex;
            gap: 0.2rem;
        }

        .star {
            font-size: 1.2rem;
            color: #e5e7eb;
            cursor: pointer;
            transition: color 0.2s;
        }

        .star.active,
        .star:hover {
            color: #ffd700;
        }

        .rating-display {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: #666;
        }

        .rating-stats {
            font-size: 0.9rem;
            color: #666;
        }

        .add-post-form {
            background: white;
            border-radius: 20px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            display: none;
        }



        /* Utility Classes */
        .cursor-pointer {
            cursor: pointer;
        }

        .text-center {
            text-align: center;
        }

        .mt-2 {
            margin-top: 1rem;
        }

        .mb-2 {
            margin-bottom: 1rem;
        }

        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header>
        <nav class="container">
            <div class="logo">
                <i class="fas fa-mountain"></i> TrekWanders
            </div>
            <ul class="nav-links">
                <li><a href="#home">Home</a></li>
                <li><a href="#destinations">Destinations</a></li>
                <li><a href="#userBookings" id="bookingsNavLink" style="display: none;">My Bookings</a></li>
                <li><a href="#feed">Feed</a></li>
                <li><a href="#about">About</a></li>
                <li><a href="#contact">Contact</a></li>
            </ul>
            <div class="auth-buttons">
                <div class="user-info" id="userInfo">
                    <div class="user-avatar" id="userAvatar"></div>
                    <div>
                        <div id="userName"></div>
                        <div class="role-badge" id="userRole">User</div>
                    </div>
                    <button class="btn btn-outline" onclick="logout()">Logout</button>
                </div>
                <div id="authButtons">
                    <button class="btn btn-outline" onclick="openAuthModal('login')">Login</button>
                    <button class="btn btn-primary" onclick="openAuthModal('signup')">Sign Up</button>
                </div>
            </div>
        </nav>
    </header>

    <!-- Hero Section -->
    <section class="hero" id="home">
        <div class="hero-background" id="heroBackground">
            <!-- Background images will be loaded here -->
        </div>
        <div class="hero-overlay"></div>
        <div class="container">
            <div class="hero-content">
                <div class="hero-text">
                    <h1>Discover Your Next Adventure</h1>
                    <p>Find and book amazing travel experiences around the world with TrekWanders</p>
                    <div class="hero-search">
                        <div class="search-form">
                            <div class="search-input">
                                <i class="fas fa-map-marker-alt"></i>
                                <input type="text" placeholder="Where do you want to go?" id="heroSearchInput">
                            </div>
                            <div class="search-input">
                                <i class="fas fa-calendar-alt"></i>
                                <input type="date" id="heroDateInput">
                            </div>
                            <button class="btn btn-primary" onclick="searchTrips()">
                                <i class="fas fa-search"></i> Search
                            </button>
                        </div>
                    </div>
                    <div class="hero-stats">
                        <div class="stat-item">
                            <i class="fas fa-map-marked-alt"></i>
                            <div>
                                <span class="stat-number">1000+</span>
                                <span class="stat-label">Destinations</span>
                            </div>
                        </div>
                        <div class="stat-item">
                            <i class="fas fa-users"></i>
                            <div>
                                <span class="stat-number">50K+</span>
                                <span class="stat-label">Happy Travelers</span>
                            </div>
                        </div>
                        <div class="stat-item">
                            <i class="fas fa-star"></i>
                            <div>
                                <span class="stat-number">4.9</span>
                                <span class="stat-label">Average Rating</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Search Section -->
    <section class="search-section">
        <div class="container">
            <div class="search-container">
                <div class="search-box">
                    <i class="fas fa-search"></i>
                    <input type="text" id="searchInput" placeholder="Search destinations, activities, or locations..." oninput="showSmartSuggestions(this.value)">
                    <div id="smartSuggestions" class="smart-suggestions" style="display: none;">
                        <h4><i class="fas fa-lightbulb"></i> Smart Suggestions</h4>
                        <div id="suggestionsList"></div>
                    </div>
                </div>
                
                <div class="advanced-filters">
                    <div class="filter-group">
                        <label>Price Range</label>
                        <div class="price-range">
                            <input type="number" id="minPrice" placeholder="Min" min="0">
                            <span>-</span>
                            <input type="number" id="maxPrice" placeholder="Max" min="0">
                        </div>
                    </div>
                    
                    <div class="filter-group">
                        <label>Duration</label>
                        <select id="durationFilter">
                            <option value="">Any Duration</option>
                            <option value="1-3">1-3 Days</option>
                            <option value="4-7">4-7 Days</option>
                            <option value="8-14">8-14 Days</option>
                            <option value="15+">15+ Days</option>
                        </select>
                    </div>
                    
                    <div class="filter-group">
                        <label>Difficulty</label>
                        <select id="difficultyFilter">
                            <option value="">Any Level</option>
                            <option value="easy">Easy</option>
                            <option value="moderate">Moderate</option>
                            <option value="challenging">Challenging</option>
                            <option value="extreme">Extreme</option>
                        </select>
                    </div>
                    
                    <div class="filter-group">
                        <label>Rating</label>
                        <select id="ratingFilter">
                            <option value="">Any Rating</option>
                            <option value="4.5">4.5+ Stars</option>
                            <option value="4.0">4.0+ Stars</option>
                            <option value="3.5">3.5+ Stars</option>
                            <option value="3.0">3.0+ Stars</option>
                        </select>
                    </div>
                    
                    <button class="btn btn-primary" onclick="applyAdvancedFilters()">
                        <i class="fas fa-filter"></i> Filter
                    </button>
                    <button class="btn btn-outline" onclick="clearAllFilters()">
                        <i class="fas fa-times"></i> Clear
                    </button>
                </div>
            </div>
            
            <!-- Simplified Categories -->
            <div class="category-filter" style="margin-top: 1rem; justify-content: center;">
                <button class="category-btn active" data-category="all">🌍 All</button>
                <button class="category-btn" data-category="adventure">🏔️ Adventure</button>
                <button class="category-btn" data-category="beach">🏖️ Beach</button>
                <button class="category-btn" data-category="mountain">⛰️ Mountain</button>
                <button class="category-btn" data-category="cultural">🏛️ Cultural</button>
                <button class="category-btn" data-category="wildlife">🦁 Wildlife</button>
            </div>
        </div>
    </section>

    <!-- Admin Panel -->
    <div class="admin-panel container" id="adminPanel">
        <h2><i class="fas fa-cog"></i> Admin Panel</h2>
        
                 <div class="admin-tabs">
             <button class="admin-tab active" onclick="showAdminTab('dashboard')"><i class="fas fa-chart-line"></i> Dashboard</button>
             <button class="admin-tab" onclick="showAdminTab('trips')"><i class="fas fa-map-marked-alt"></i> Manage Trips</button>
                             <button class="admin-tab" onclick="showAdminTab('images')"><i class="fas fa-images"></i> Hero Images</button>
                <button class="admin-tab" onclick="showAdminTab('footer')"><i class="fas fa-edit"></i> Footer</button>
             <button class="admin-tab" onclick="showAdminTab('bookings')"><i class="fas fa-calendar-check"></i> Bookings</button>
             <button class="admin-tab" onclick="showAdminTab('users')"><i class="fas fa-users"></i> Users</button>
             <button class="admin-tab" onclick="showAdminTab('analytics')"><i class="fas fa-analytics"></i> Analytics</button>
         </div>

                 <!-- Dashboard -->
         <div class="admin-content active" id="dashboardAdmin">
             <div class="dashboard-stats" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 2rem; margin-bottom: 2rem;">
                 <div class="stat-card" style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; padding: 2rem; border-radius: 15px; text-align: center;">
                     <i class="fas fa-users" style="font-size: 3rem; margin-bottom: 1rem;"></i>
                     <h3 id="totalUsers">0</h3>
                     <p>Total Users</p>
                 </div>
                 <div class="stat-card" style="background: linear-gradient(135deg, #f093fb, #f5576c); color: white; padding: 2rem; border-radius: 15px; text-align: center;">
                     <i class="fas fa-calendar-check" style="font-size: 3rem; margin-bottom: 1rem;"></i>
                     <h3 id="totalBookings">0</h3>
                     <p>Total Bookings</p>
                 </div>
                 <div class="stat-card" style="background: linear-gradient(135deg, #4facfe, #00f2fe); color: white; padding: 2rem; border-radius: 15px; text-align: center;">
                     <i class="fas fa-map-marked-alt" style="font-size: 3rem; margin-bottom: 1rem;"></i>
                     <h3 id="totalTrips">0</h3>
                     <p>Total Trips</p>
                 </div>
                 <div class="stat-card" style="background: linear-gradient(135deg, #43e97b, #38f9d7); color: white; padding: 2rem; border-radius: 15px; text-align: center;">
                     <i class="fas fa-dollar-sign" style="font-size: 3rem; margin-bottom: 1rem;"></i>
                                             <h3 id="totalRevenue">₹0</h3>
                     <p>Revenue</p>
                 </div>
             </div>
             
             <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem;">
                 <div style="background: white; padding: 2rem; border-radius: 15px; box-shadow: 0 5px 15px rgba(0,0,0,0.1);">
                     <h3><i class="fas fa-calendar-check"></i> Recent Bookings</h3>
                     <div id="recentBookings">
                         <div style="text-align: center; padding: 2rem; color: #666;">
                             <i class="fas fa-calendar-alt" style="font-size: 3rem; margin-bottom: 1rem; opacity: 0.3;"></i>
                             <p>No recent bookings</p>
                         </div>
                     </div>
                 </div>
                 <div style="background: white; padding: 2rem; border-radius: 15px; box-shadow: 0 5px 15px rgba(0,0,0,0.1);">
                     <h3><i class="fas fa-chart-pie"></i> Trip Categories</h3>
                     <canvas id="categoryChart" width="400" height="200"></canvas>
                 </div>
             </div>
             
             <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; margin-top: 2rem;">
                 <div style="background: white; padding: 2rem; border-radius: 15px; box-shadow: 0 5px 15px rgba(0,0,0,0.1);">
                     <h3><i class="fas fa-star"></i> Rating Distribution</h3>
                     <canvas id="ratingChart" width="400" height="200"></canvas>
                 </div>
                 <div style="background: white; padding: 2rem; border-radius: 15px; box-shadow: 0 5px 15px rgba(0,0,0,0.1);">
                     <h3><i class="fas fa-clock"></i> Booking Trends</h3>
                     <canvas id="trendChart" width="400" height="200"></canvas>
                 </div>
             </div>
         </div>

         <!-- Trip Management -->
         <div class="admin-content" id="tripsAdmin">
            <form class="admin-form" id="adminForm">
                <div class="form-group">
                    <label for="tripTitle">Trip Title</label>
                    <input type="text" id="tripTitle" required>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="tripLocation">Location</label>
                        <input type="text" id="tripLocation" required>
                    </div>
                    <div class="form-group">
                        <label for="tripDuration">Duration</label>
                        <input type="text" id="tripDuration" placeholder="e.g., 5 Days 4 Nights" required>
                    </div>
                </div>

                <div class="form-group">
                    <label for="tripImages">Trip Images</label>
                    <div class="image-upload-section">
                        <div class="upload-area">
                            <i class="fas fa-cloud-upload-alt" style="font-size: 3rem; color: #2563eb;"></i>
                            <h4>Upload Images</h4>
                            <p>Upload multiple images or enter URLs</p>
                            <input type="file" id="tripImageFiles" multiple accept="image/*" style="display: none;">
                            <button type="button" class="upload-btn" onclick="document.getElementById('tripImageFiles').click()">
                                <i class="fas fa-upload"></i> Choose Files
                            </button>
                            <div style="margin: 1rem 0;">OR</div>
                            <textarea id="tripImages" rows="3" placeholder="Enter image URLs, one per line" style="width: 100%; margin-top: 1rem;"></textarea>
                        </div>
                        <div id="tripImagePreview" class="image-preview"></div>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="tripPrice">Price</label>
                        <input type="text" id="tripPrice" placeholder="e.g., ₹1,99,999" required>
                    </div>
                    <div class="form-group">
                        <label for="tripRating">Rating (1-5)</label>
                        <input type="number" id="tripRating" min="1" max="5" step="0.1" required>
                    </div>
                </div>

                <div class="form-group">
                    <label for="tripDescription">Description</label>
                    <textarea id="tripDescription" rows="4" required></textarea>
                </div>

                <div class="form-group">
                    <label for="tripRequirements">Requirements (one per line)</label>
                    <textarea id="tripRequirements" rows="4" placeholder="e.g., Valid Passport&#10;Good Physical Fitness&#10;Travel Insurance"></textarea>
                </div>

                <div class="form-group">
                    <label for="tripVideo">Video URL (YouTube)</label>
                    <input type="url" id="tripVideo" placeholder="https://www.youtube.com/embed/...">
                </div>

                <div class="form-row">
                                    <div class="form-group">
                    <label for="tripCategory">Trip Category</label>
                    <select id="tripCategory" required>
                        <option value="adventure">🏔️ Adventure</option>
                        <option value="beach">🏖️ Beach</option>
                        <option value="mountain">⛰️ Mountain</option>
                        <option value="cultural">🏛️ Cultural</option>
                        <option value="wildlife">🦁 Wildlife</option>
                        <option value="hiking">🥾 Hiking</option>
                        <option value="temple">🏯 Temple</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="tripSection">Section</label>
                    <select id="tripSection" required>
                        <option value="trending">Trending</option>
                        <option value="upcoming">Upcoming</option>
                        <option value="ongoing">Ongoing</option>
                        <option value="past">Past</option>
                    </select>
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="tripDifficulty">Difficulty Level</label>
                    <select id="tripDifficulty" required>
                        <option value="easy">Easy</option>
                        <option value="moderate">Moderate</option>
                        <option value="challenging">Challenging</option>
                        <option value="extreme">Extreme</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="tripPriceNumber">Price (Numbers only)</label>
                    <input type="number" id="tripPriceNumber" placeholder="e.g., 2999" required>
                </div>
                </div>

                <button type="submit" class="btn btn-primary">
                    <span id="adminSubmitText">Add Trip</span>
                    <div class="loading" id="adminLoading" style="display: none;"></div>
                </button>
            </form>
        </div>

        <!-- Hero Images Management -->
        <div class="admin-content" id="imagesAdmin">
            <div class="hero-image-manager">
                <h3><i class="fas fa-images"></i> Manage Hero Background Images</h3>
                <p>Upload or add URLs for hero section background images. Images will auto-rotate every 5 seconds.</p>
                
                <div class="image-upload-section">
                    <div class="upload-area">
                        <i class="fas fa-mountain" style="font-size: 3rem; color: #2563eb;"></i>
                        <h4>Add New Hero Image</h4>
                        <input type="file" id="heroImageFile" accept="image/*" style="display: none;">
                        <button type="button" class="upload-btn" onclick="document.getElementById('heroImageFile').click()">
                            <i class="fas fa-upload"></i> Upload Image
                        </button>
                        <div style="margin: 1rem 0;">OR</div>
                        <input type="url" id="heroImageUrl" placeholder="Enter image URL" style="width: 100%; padding: 0.8rem; border: 2px solid #e5e7eb; border-radius: 10px;">
                        <button type="button" class="btn btn-primary" onclick="addHeroImageFromUrl()" style="margin-top: 1rem;">
                            <i class="fas fa-plus"></i> Add URL
                        </button>
                    </div>
                </div>

                <div class="hero-images-grid" id="heroImagesGrid">
                    <!-- Hero images will be loaded here -->
                </div>
            </div>
        </div>

        <!-- Footer & Social Media Management -->
        <div class="admin-content" id="footerAdmin">
            <div class="footer-manager">
                <h3><i class="fas fa-edit"></i> Footer & Social Media Management</h3>
                <p>Manage contact information and social media links displayed in the footer.</p>
                
                <div class="footer-management-grid">
                    <div class="contact-management">
                        <h4><i class="fas fa-address-book"></i> Contact Information</h4>
                        <div class="form-group">
                            <label>Email Address</label>
                            <input type="email" id="adminContactEmail" placeholder="info@trekwanders.com">
                        </div>
                        <div class="form-group">
                            <label>Phone Number</label>
                            <input type="tel" id="adminContactPhone" placeholder="+91 98765 43210">
                        </div>
                        <div class="form-group">
                            <label>Address</label>
                            <input type="text" id="adminContactAddress" placeholder="Mumbai, Maharashtra, India">
                        </div>
                        <button class="btn btn-primary" onclick="updateContactInfo()">
                            <i class="fas fa-save"></i> Update Contact Info
                        </button>
                    </div>
                    
                    <div class="social-management">
                        <h4><i class="fas fa-share-alt"></i> Social Media Links</h4>
                        <div class="form-group">
                            <label><i class="fab fa-facebook-f"></i> Facebook</label>
                            <input type="url" id="adminFacebookLink" placeholder="https://facebook.com/trekwanders">
                        </div>
                        <div class="form-group">
                            <label><i class="fab fa-twitter"></i> Twitter</label>
                            <input type="url" id="adminTwitterLink" placeholder="https://twitter.com/trekwanders">
                        </div>
                        <div class="form-group">
                            <label><i class="fab fa-instagram"></i> Instagram</label>
                            <input type="url" id="adminInstagramLink" placeholder="https://instagram.com/trekwanders">
                        </div>
                        <div class="form-group">
                            <label><i class="fab fa-linkedin-in"></i> LinkedIn</label>
                            <input type="url" id="adminLinkedinLink" placeholder="https://linkedin.com/company/trekwanders">
                        </div>
                        <div class="form-group">
                            <label><i class="fab fa-youtube"></i> YouTube</label>
                            <input type="url" id="adminYoutubeLink" placeholder="https://youtube.com/trekwanders">
                        </div>
                        <button class="btn btn-primary" onclick="updateSocialLinks()">
                            <i class="fas fa-save"></i> Update Social Links
                        </button>
                    </div>
                </div>
            </div>
        </div>

                 <!-- Booking Management -->
         <div class="admin-content" id="bookingsAdmin">
             <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
                 <h3><i class="fas fa-calendar-check"></i> Booking Management</h3>
                 <div>
                     <button class="btn btn-primary" onclick="loadAllBookings()"><i class="fas fa-sync"></i> Refresh</button>
                     <select id="bookingStatusFilter" onchange="filterBookings()" style="margin-left: 1rem; padding: 0.5rem; border-radius: 5px;">
                         <option value="all">All Bookings</option>
                         <option value="pending">Pending</option>
                         <option value="confirmed">Confirmed</option>
                         <option value="cancelled">Cancelled</option>
                         <option value="completed">Completed</option>
                     </select>
                 </div>
             </div>
             
             <div class="bookings-grid" id="bookingsGrid">
                 <!-- Bookings will be loaded here -->
             </div>
         </div>

         <!-- Analytics -->
         <div class="admin-content" id="analyticsAdmin">
             <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; margin-bottom: 2rem;">
                 <div style="background: white; padding: 2rem; border-radius: 15px; box-shadow: 0 5px 15px rgba(0,0,0,0.1);">
                     <h3>Booking Trends</h3>
                     <canvas id="bookingTrendsChart" width="400" height="200"></canvas>
                 </div>
                 <div style="background: white; padding: 2rem; border-radius: 15px; box-shadow: 0 5px 15px rgba(0,0,0,0.1);">
                     <h3>Revenue by Month</h3>
                     <canvas id="revenueChart" width="400" height="200"></canvas>
                 </div>
             </div>
             
             <div style="background: white; padding: 2rem; border-radius: 15px; box-shadow: 0 5px 15px rgba(0,0,0,0.1);">
                 <h3>User Activity</h3>
                 <canvas id="userActivityChart" width="800" height="300"></canvas>
             </div>
         </div>

        <!-- User Role Management -->
        <div class="admin-content" id="usersAdmin">
            <h3>User Role Management</h3>
            <div id="usersList">
                <!-- Users will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Destinations Section -->
    <section class="section" id="destinations">
        <div class="container">
            <div class="section-title">
                <h2>Popular Destinations</h2>
                <p>Unleash Your Wanderlust With TrekWanders</p>
            </div>

            <div class="tab-buttons">
                <button class="tab-button active" onclick="showTab('trending')">Trending</button>
                <button class="tab-button" onclick="showTab('ongoing')">Ongoing</button>
                <button class="tab-button" onclick="showTab('upcoming')">Upcoming</button>
                <button class="tab-button" onclick="showTab('past')">Past Adventures</button>
            </div>

            <div class="tab-content active" id="trending">
                <div class="trips-grid" id="trendingTrips">
                    <!-- Trending trips will be loaded here -->
                </div>
            </div>

            <div class="tab-content" id="ongoing">
                <div class="trips-grid" id="ongoingTrips">
                    <!-- Ongoing trips will be loaded here -->
                </div>
            </div>

            <div class="tab-content" id="upcoming">
                <div class="trips-grid" id="upcomingTrips">
                    <!-- Upcoming trips will be loaded here -->
                </div>
            </div>

            <div class="tab-content" id="past">
                <div class="trips-grid" id="pastTrips">
                    <!-- Past trips will be loaded here -->
                </div>
            </div>
        </div>
    </section>

    <!-- User Bookings Section -->
    <section class="user-bookings-section" id="userBookings" style="display: none;">
        <div class="container">
            <div class="section-title">
                <h2><i class="fas fa-calendar-check"></i> My Bookings</h2>
                <p>Track and manage your travel bookings</p>
            </div>
            
            <div class="bookings-grid" id="userBookingsGrid">
                <!-- User bookings will be loaded here -->
            </div>
        </div>
    </section>

    <!-- Feed Section -->
    <section class="feed-section section" id="feed">
        <div class="container">
            <div class="section-title">
                <h2>Travel Feed</h2>
                <p>Latest updates, stories, and announcements from TrekWanders</p>
            </div>

            <!-- Add Post Form (Admin Only) -->
            <div class="add-post-form" id="addPostForm">
                <h3>Create New Post</h3>
                <form id="feedPostForm">
                    <div class="form-group">
                        <label for="postTitle">Post Title</label>
                        <input type="text" id="postTitle" required>
                    </div>
                    <div class="form-group">
                        <label for="postContent">Content</label>
                        <textarea id="postContent" rows="4" required></textarea>
                    </div>
                    <div class="form-group">
                        <label for="postImage">Image (optional)</label>
                        <div class="image-upload-section">
                            <div class="upload-area">
                                <input type="file" id="postImageFile" accept="image/*" style="display: none;">
                                <button type="button" class="upload-btn" onclick="document.getElementById('postImageFile').click()">
                                    <i class="fas fa-upload"></i> Upload Image
                                </button>
                                <div style="margin: 0.5rem 0;">OR</div>
                                <input type="url" id="postImage" placeholder="Enter image URL" style="width: 100%; padding: 0.5rem; border: 1px solid #e5e7eb; border-radius: 5px;">
                            </div>
                            <div id="postImagePreview" class="image-preview"></div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="postVideo">YouTube Video (optional)</label>
                        <input type="url" id="postVideo" placeholder="https://www.youtube.com/watch?v=...">
                    </div>
                    <div style="display: flex; gap: 1rem;">
                        <button type="submit" class="btn btn-primary">Post</button>
                        <button type="button" class="btn btn-outline" onclick="hideAddPostForm()">Cancel</button>
                    </div>
                </form>
            </div>

            <div style="text-align: center; margin-bottom: 2rem;">
                <button class="btn btn-primary" onclick="showAddPostForm()" id="addPostBtn" style="display: none;">
                    <i class="fas fa-plus"></i> Add New Post
                </button>
            </div>

            <div class="feed-posts-grid" id="feedPosts">
                <!-- Feed posts will be loaded here -->
            </div>
        </div>
    </section>

    <!-- Trip Details Modal -->
    <div id="tripModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-image-gallery" id="modalImageGallery">
                    <!-- Images will be loaded here -->
                </div>
                <button class="image-nav prev" onclick="previousImage()">❮</button>
                <button class="image-nav next" onclick="nextImage()">❯</button>
                <div class="image-indicators" id="imageIndicators">
                    <!-- Indicators will be loaded here -->
                </div>
                <span class="close">&times;</span>
                <div class="admin-actions" id="modalAdminActions" style="display: none;">
                    <button class="admin-btn" onclick="editTrip()"><i class="fas fa-edit"></i></button>
                    <button class="admin-btn" onclick="deleteTrip()"><i class="fas fa-trash"></i></button>
                </div>
            </div>
            <div class="modal-body">
                <div class="modal-info">
                    <div class="trip-details">
                        <h2 id="modalTitle"></h2>
                        <div class="trip-meta">
                            <div class="meta-item">
                                <i class="fas fa-map-marker-alt"></i>
                                <span id="modalLocation"></span>
                            </div>
                            <div class="meta-item">
                                <i class="fas fa-clock"></i>
                                <span id="modalDuration"></span>
                            </div>
                            <div class="meta-item">
                                <div class="stars" id="modalStars"></div>
                                <span id="modalRating"></span>
                            </div>
                        </div>
                        <div class="trip-description" id="modalDescription"></div>
                        
                        <div class="requirements" id="modalRequirements">
                            <h4><i class="fas fa-list-check"></i> Requirements</h4>
                            <ul id="requirementsList">
                                <!-- Requirements will be loaded here -->
                            </ul>
                        </div>

                        <div class="video-container" id="modalVideoContainer" style="display: none;">
                            <iframe id="modalVideo" src="" allowfullscreen></iframe>
                        </div>
                    </div>

                    <div class="booking-card">
                        <div class="price-display">
                            <div class="price-amount" id="modalPrice"></div>
                            <div class="price-per">per person</div>
                        </div>
                        
                        <form class="booking-form" id="bookingForm">
                            <div class="form-group">
                                <label for="bookingName">Full Name *</label>
                                <input type="text" id="bookingName" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="bookingEmail">Email *</label>
                                <input type="email" id="bookingEmail" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="bookingPhone">Phone Number *</label>
                                <input type="tel" id="bookingPhone" required>
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label for="adultCount">Adults</label>
                                    <select id="adultCount">
                                        <option value="1">1 Adult</option>
                                        <option value="2">2 Adults</option>
                                        <option value="3">3 Adults</option>
                                        <option value="4">4 Adults</option>
                                        <option value="5">5+ Adults</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="childCount">Children</label>
                                    <select id="childCount">
                                        <option value="0">0 Children</option>
                                        <option value="1">1 Child</option>
                                        <option value="2">2 Children</option>
                                        <option value="3">3 Children</option>
                                        <option value="4">4+ Children</option>
                                    </select>
                                </div>
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label for="seniorCount">Seniors (60+)</label>
                                    <select id="seniorCount">
                                        <option value="0">0 Seniors</option>
                                        <option value="1">1 Senior</option>
                                        <option value="2">2 Seniors</option>
                                        <option value="3">3+ Seniors</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="genderMix">Group Composition</label>
                                    <select id="genderMix">
                                        <option value="mixed">Mixed Group</option>
                                        <option value="male">All Male</option>
                                        <option value="female">All Female</option>
                                        <option value="family">Family</option>
                                    </select>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="bookingDate">Preferred Date</label>
                                <input type="date" id="bookingDate" required>
                            </div>

                            <div class="form-group">
                                <label for="specialRequests">Special Requests</label>
                                <textarea id="specialRequests" rows="3" placeholder="Any dietary restrictions, medical conditions, or special requirements..."></textarea>
                            </div>

                            <button type="submit" class="btn btn-primary" style="width: 100%;">
                                <i class="fas fa-ticket-alt"></i> Book Now
                                <div class="loading" id="bookingLoading" style="display: none;"></div>
                            </button>
                        </form>
                    </div>
                </div>

                <!-- Reviews Section -->
                <div class="reviews-section">
                    <div class="reviews-header">
                        <h3><i class="fas fa-star"></i> Reviews & Ratings</h3>
                        <button class="btn btn-outline" onclick="showAddReviewForm()" id="addReviewBtn" style="display: none;">Add Review</button>
                    </div>
                    
                    <div id="addReviewForm" class="review-card" style="display: none;">
                        <form id="reviewForm">
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="reviewRating">Rating</label>
                                    <select id="reviewRating" required>
                                        <option value="5">5 Stars - Excellent</option>
                                        <option value="4">4 Stars - Very Good</option>
                                        <option value="3">3 Stars - Good</option>
                                        <option value="2">2 Stars - Fair</option>
                                        <option value="1">1 Star - Poor</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="reviewTitle">Review Title</label>
                                    <input type="text" id="reviewTitle" required>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="reviewText">Your Review</label>
                                <textarea id="reviewText" rows="4" required></textarea>
                            </div>
                            <div style="display: flex; gap: 1rem;">
                                <button type="submit" class="btn btn-primary">
                                    Submit Review
                                    <div class="loading" id="reviewLoading" style="display: none;"></div>
                                </button>
                                <button type="button" class="btn btn-outline" onclick="hideAddReviewForm()">Cancel</button>
                            </div>
                        </form>
                    </div>

                    <div id="reviewsList">
                        <!-- Reviews will be loaded here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Auth Modal -->
    <div id="authModal" class="auth-modal">
        <div class="auth-form">
            <span class="close" onclick="closeAuthModal()">&times;</span>
            <h2 id="authTitle">Login</h2>
            <form id="authFormElement">
                <div class="form-group" id="usernameField" style="display: none;">
                    <label for="authUsername">Username</label>
                    <input type="text" id="authUsername">
                </div>
                <div class="form-group">
                    <label for="authEmail">Email</label>
                    <input type="email" id="authEmail" required>
                </div>
                <div class="form-group" id="phoneField" style="display: none;">
                    <label for="authPhone">Phone Number</label>
                    <input type="tel" id="authPhone">
                </div>
                <div class="form-group">
                    <label for="authPassword">Password</label>
                    <input type="password" id="authPassword" required>
                </div>
                <button type="submit" class="btn btn-primary" style="width: 100%;">
                    <span id="authSubmitText">Login</span>
                    <div class="loading" id="authLoading" style="display: none;"></div>
                </button>
            </form>
            <p style="text-align: center; margin-top: 1rem;">
                <span id="authSwitchText">Don't have an account?</span>
                <a href="#" id="authSwitchLink" onclick="switchAuthMode()">Sign up</a>
            </p>
        </div>
    </div>

    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-database-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-storage-compat.js"></script>
    
    <!-- SweetAlert2 for beautiful alerts - Free CDN -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    
    <!-- Chart.js for analytics - Free CDN -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Toastify for notifications - Free and unlimited -->
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/toastify-js"></script>

    <script>
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyAL5e-5eQfgf1nI6hWTnhwLFgK0Cp89aa0",
            authDomain: "aviator-pr01.firebaseapp.com",
            databaseURL: "https://aviator-pr01-default-rtdb.firebaseio.com",
            projectId: "aviator-pr01",
            storageBucket: "aviator-pr01.firebasestorage.app",
            messagingSenderId: "290788041297",
            appId: "1:290788041297:web:168f99d1532997fb778e70",
            measurementId: "G-ENCBTT4BL8"
        };

        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();
        const database = firebase.database();
        const storage = firebase.storage();

        let currentUser = null;
        let isAdmin = false;
        let currentTripId = null;
        let authMode = 'login';
        let currentImageIndex = 0;
        let currentTripImages = [];
        let allTrips = [];
        let filteredTrips = [];
        let currentTripLocation = '';
        let heroImages = [];
        let currentHeroImageIndex = 0;
        let heroImageInterval;

        // Image Storage Configuration
        // Priority: Firebase Storage > ImgBB > Cloudinary > PostImages > Base64
        
        // Option 1: ImgBB (Free: 1000 uploads/month, Unlimited storage)
        // Get API key from: https://api.imgbb.com/
        window.IMGBB_API_KEY = ''; // Add your ImgBB API key here
        
        // Option 2: Cloudinary (Free: 25GB storage, Advanced features)
        // Get credentials from: https://cloudinary.com/
        window.CLOUDINARY_CONFIG = {
            cloudName: '', // Your cloud name
            uploadPreset: '' // Your upload preset (set in Cloudinary dashboard)
        };
        
        // Firebase Storage is automatically used if available (Recommended)
        // Currently configured in your Firebase project

        // Sample trips data with enhanced features
        const sampleTrips = [
            {
                id: 'sample1',
                title: 'Himalayan Adventure Trek',
                location: 'Nepal Himalayas',
                duration: '12 Days 11 Nights',
                images: [
                    'https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=800&h=600&fit=crop',
                    'https://images.unsplash.com/photo-1544735716-392fe2489ffa?w=800&h=600&fit=crop',
                    'https://images.unsplash.com/photo-1571863533956-01c88e79957e?w=800&h=600&fit=crop'
                ],
                                    price: '₹1,99,999',
                priceNumber: 2499,
                difficulty: 'challenging',
                rating: 4.9,
                description: 'Embark on an unforgettable journey through the majestic Himalayas. Experience breathtaking mountain views, ancient monasteries, and the warm hospitality of Sherpa communities.',
                requirements: ['Valid Passport', 'Good Physical Fitness', 'Travel Insurance', 'Warm Clothing', 'Trekking Experience'],
                videoUrl: 'https://www.youtube.com/embed/dQw4w9WgXcQ',
                category: 'adventure',
                section: 'trending'
            },
            {
                id: 'sample2',
                title: 'Sacred Temple Journey',
                location: 'Varanasi, India',
                duration: '7 Days 6 Nights',
                images: [
                    'https://images.unsplash.com/photo-1564507592333-c60657eea523?w=800&h=600&fit=crop',
                    'https://images.unsplash.com/photo-1524492412937-b28074a5d7da?w=800&h=600&fit=crop'
                ],
                                    price: '₹71,999',
                priceNumber: 899,
                difficulty: 'easy',
                rating: 4.7,
                description: 'Discover the spiritual heart of India with visits to ancient temples, evening aarti ceremonies, and peaceful meditation sessions along the sacred Ganges.',
                requirements: ['Respectful Attire', 'Open Mind', 'Comfortable Walking Shoes'],
                category: 'cultural',
                section: 'upcoming'
            },
            {
                id: 'sample3',
                title: 'Tropical Paradise Escape',
                location: 'Maldives',
                duration: '5 Days 4 Nights',
                images: [
                    'https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=800&h=600&fit=crop'
                ],
                                    price: '₹2,63,999',
                priceNumber: 3299,
                difficulty: 'easy',
                rating: 4.8,
                description: 'Experience ultimate luxury in overwater bungalows with crystal clear waters, pristine beaches, and world-class diving.',
                requirements: ['Swimming Ability', 'Sun Protection', 'Snorkeling Gear Provided'],
                category: 'beach',
                section: 'ongoing'
            },
            {
                id: 'sample4',
                title: 'Ancient Ruins Explorer',
                location: 'Machu Picchu, Peru',
                duration: '8 Days 7 Nights',
                images: [
                    'https://images.unsplash.com/photo-1587595431973-160d0d94add1?w=800&h=600&fit=crop'
                ],
                                    price: '₹1,51,999',
                priceNumber: 1899,
                difficulty: 'moderate',
                rating: 4.6,
                description: 'Explore the mystical ruins of Machu Picchu and learn about ancient Incan civilization.',
                requirements: ['Good Physical Condition', 'Altitude Preparation', 'Valid Passport'],
                category: 'cultural',
                section: 'past'
            },
            {
                id: 'sample5',
                title: 'African Safari Adventure',
                location: 'Serengeti, Tanzania',
                duration: '10 Days 9 Nights',
                images: [
                    'https://images.unsplash.com/photo-1516426122078-c23e76319801?w=800&h=600&fit=crop'
                ],
                                    price: '₹2,79,999',
                priceNumber: 3499,
                difficulty: 'moderate',
                rating: 4.8,
                description: 'Experience the incredible wildlife of Africa with game drives, luxury lodges, and unforgettable animal encounters.',
                requirements: ['Valid Passport', 'Yellow Fever Vaccination', 'Safari Clothing'],
                category: 'wildlife',
                section: 'trending'
            }
        ];

        // Initialize the app
        document.addEventListener('DOMContentLoaded', function() {
            loadSampleTrips();
            loadSampleFeedPosts();
            loadFeedPosts(true);
            setupEventListeners();
            initializeFreeFeatures();
            initializeHeroImages();
            loadFooterSettings();
            
            // Check authentication state
            auth.onAuthStateChanged(user => {
                if (user) {
                    currentUser = user;
                    checkUserRole(user);
                } else {
                    currentUser = null;
                    isAdmin = false;
                    updateUIForGuest();
                }
            });
        });

        async function checkUserRole(user) {
            try {
                // Check user role in Realtime Database
                const userRef = database.ref('users/' + user.uid);
                const snapshot = await userRef.once('value');
                
                if (snapshot.exists()) {
                    const userData = snapshot.val();
                    isAdmin = userData.role === 'admin';
                    
                    // Update last login
                    await userRef.update({
                        lastLogin: firebase.database.ServerValue.TIMESTAMP
                    });
                } else {
                    // Create user document with default role and complete data in Realtime Database
                    const userData = {
                        email: user.email,
                        uid: user.uid,
                        role: 'user',
                        joinDate: firebase.database.ServerValue.TIMESTAMP,
                        createdAt: firebase.database.ServerValue.TIMESTAMP,
                        displayName: user.displayName || user.email.split('@')[0],
                        lastLogin: firebase.database.ServerValue.TIMESTAMP,
                        profilePicture: user.photoURL || '',
                        isActive: true
                    };
                    
                    await userRef.set(userData);
                    isAdmin = false;
                }
                
                updateUIForUser(user);
                if (isAdmin) {
                    loadTripsFromFirestore();
                    loadUsersList();
                    loadFeedPosts();
                    loadAnalyticsDashboard();
                }
            } catch (error) {
                console.error('Error checking user role:', error);
                isAdmin = false;
                updateUIForUser(user);
            }
        }

        function loadSampleTrips() {
            allTrips = [...sampleTrips];
            filteredTrips = [...allTrips];
            renderTrips();
        }

        function renderTrips() {
            const containers = {
                trending: document.getElementById('trendingTrips'),
                ongoing: document.getElementById('ongoingTrips'),
                upcoming: document.getElementById('upcomingTrips'),
                past: document.getElementById('pastTrips')
            };

            // Clear containers
            Object.values(containers).forEach(container => {
                container.innerHTML = '';
            });

            // Render filtered trips
            filteredTrips.forEach(trip => {
                const tripCard = createTripCard(trip);
                if (containers[trip.section]) {
                    containers[trip.section].appendChild(tripCard);
                }
            });
        }

        function setupEventListeners() {
            // Auth form submission
            document.getElementById('authFormElement').addEventListener('submit', handleAuth);
            
            // Admin form submission
            document.getElementById('adminForm').addEventListener('submit', handleAdminSubmit);
            
            // Booking form submission
            document.getElementById('bookingForm').addEventListener('submit', handleBookingSubmit);
            
            // Review form submission
            document.getElementById('reviewForm').addEventListener('submit', handleReviewSubmit);
            
            // Feed form submission
            document.getElementById('feedPostForm').addEventListener('submit', handleFeedPostSubmit);
            
            // Image upload handlers
            document.getElementById('tripImageFiles').addEventListener('change', handleTripImageUpload);
            document.getElementById('heroImageFile').addEventListener('change', handleHeroImageUpload);
            
            // Search functionality
            document.getElementById('searchInput').addEventListener('input', handleSearch);
            
            // Category filter
            document.querySelectorAll('.category-btn').forEach(btn => {
                btn.addEventListener('click', handleCategoryFilter);
            });
            
            // Modal close events
            document.querySelectorAll('.close').forEach(closeBtn => {
                closeBtn.addEventListener('click', function() {
                    this.closest('.modal, .auth-modal').style.display = 'none';
                });
            });
            
            // Click outside modal to close
            window.addEventListener('click', function(event) {
                if (event.target.classList.contains('modal') || event.target.classList.contains('auth-modal')) {
                    event.target.style.display = 'none';
                }
            });
        }

        function handleSearch() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            filteredTrips = allTrips.filter(trip => 
                trip.title.toLowerCase().includes(searchTerm) ||
                trip.location.toLowerCase().includes(searchTerm) ||
                trip.category.toLowerCase().includes(searchTerm) ||
                trip.description.toLowerCase().includes(searchTerm)
            );
            renderTrips();
        }

        function handleCategoryFilter(event) {
            // Update active button
            document.querySelectorAll('.category-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            const category = event.target.dataset.category;
            if (category === 'all') {
                filteredTrips = [...allTrips];
            } else {
                filteredTrips = allTrips.filter(trip => trip.category === category);
            }
            renderTrips();
        }

        function updateUIForUser(user) {
            document.getElementById('authButtons').style.display = 'none';
            document.getElementById('userInfo').style.display = 'flex';
            document.getElementById('userName').textContent = user.displayName || user.email.split('@')[0];
            document.getElementById('userAvatar').textContent = (user.displayName || user.email)[0].toUpperCase();
            
            // Show My Bookings link for logged in users
            document.getElementById('bookingsNavLink').style.display = 'block';
            document.getElementById('userBookings').style.display = 'block';
            loadUserBookings();
            
            const roleElement = document.getElementById('userRole');
            if (isAdmin) {
                roleElement.textContent = 'Admin';
                roleElement.classList.add('admin');
                document.getElementById('adminPanel').style.display = 'block';
                document.getElementById('addPostBtn').style.display = 'inline-block';
                document.querySelectorAll('.admin-actions').forEach(el => el.style.display = 'flex');
                loadAllBookings(); // Load admin bookings
            } else {
                roleElement.textContent = 'User';
                roleElement.classList.remove('admin');
                document.getElementById('addPostBtn').style.display = 'none';
            }
        }

        function updateUIForGuest() {
            document.getElementById('authButtons').style.display = 'flex';
            document.getElementById('userInfo').style.display = 'none';
            document.getElementById('adminPanel').style.display = 'none';
            document.getElementById('addPostBtn').style.display = 'none';
            document.getElementById('bookingsNavLink').style.display = 'none';
            document.getElementById('userBookings').style.display = 'none';
            document.querySelectorAll('.admin-actions').forEach(el => el.style.display = 'none');
        }

        function openAuthModal(mode) {
            authMode = mode;
            document.getElementById('authModal').style.display = 'flex';
            
            if (mode === 'login') {
                document.getElementById('authTitle').textContent = 'Login';
                document.getElementById('authSubmitText').textContent = 'Login';
                document.getElementById('authSwitchText').textContent = "Don't have an account?";
                document.getElementById('authSwitchLink').textContent = 'Sign up';
                document.getElementById('usernameField').style.display = 'none';
                document.getElementById('phoneField').style.display = 'none';
                document.getElementById('authUsername').required = false;
                document.getElementById('authPhone').required = false;
            } else {
                document.getElementById('authTitle').textContent = 'Sign Up';
                document.getElementById('authSubmitText').textContent = 'Sign Up';
                document.getElementById('authSwitchText').textContent = 'Already have an account?';
                document.getElementById('authSwitchLink').textContent = 'Login';
                document.getElementById('usernameField').style.display = 'block';
                document.getElementById('phoneField').style.display = 'block';
                document.getElementById('authUsername').required = true;
                document.getElementById('authPhone').required = true;
            }
        }

        function closeAuthModal() {
            document.getElementById('authModal').style.display = 'none';
            document.getElementById('authFormElement').reset();
        }

        function switchAuthMode() {
            authMode = authMode === 'login' ? 'signup' : 'login';
            openAuthModal(authMode);
        }

        async function handleAuth(e) {
            e.preventDefault();
            
            const email = document.getElementById('authEmail').value;
            const password = document.getElementById('authPassword').value;
            
            document.getElementById('authLoading').style.display = 'inline-block';
            document.getElementById('authSubmitText').style.display = 'none';
            
            try {
                if (authMode === 'login') {
                    await auth.signInWithEmailAndPassword(email, password);
                } else {
                    const username = document.getElementById('authUsername').value;
                    const phone = document.getElementById('authPhone').value;
                    
                    const userCredential = await auth.createUserWithEmailAndPassword(email, password);
                    // Set default role as user with complete data in Realtime Database
                    const userRef = database.ref('users/' + userCredential.user.uid);
                    await userRef.set({
                        email: email,
                        uid: userCredential.user.uid,
                        username: username,
                        phone: phone,
                        role: 'user',
                        joinDate: firebase.database.ServerValue.TIMESTAMP,
                        createdAt: firebase.database.ServerValue.TIMESTAMP,
                        displayName: username || email.split('@')[0],
                        lastLogin: firebase.database.ServerValue.TIMESTAMP,
                        profilePicture: '',
                        isActive: true
                    });
                }
                closeAuthModal();
            } catch (error) {
                alert('Error: ' + error.message);
            } finally {
                document.getElementById('authLoading').style.display = 'none';
                document.getElementById('authSubmitText').style.display = 'inline';
            }
        }

        function logout() {
            auth.signOut();
        }

        function showTab(tabName) {
            // Update tab buttons
            document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            // Update tab content
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            document.getElementById(tabName).classList.add('active');
        }

        function showAdminTab(tabName) {
            // Update admin tab buttons
            document.querySelectorAll('.admin-tab').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            // Update admin tab content
            document.querySelectorAll('.admin-content').forEach(content => content.classList.remove('active'));
            document.getElementById(tabName + 'Admin').classList.add('active');
            
            // Load specific data for tabs
            if (tabName === 'footer') {
                loadFooterSettings();
            }
        }

        function createTripCard(trip) {
            const card = document.createElement('div');
            card.className = 'trip-card';
            card.onclick = () => openTripModal(trip);
            
            const stars = '★'.repeat(Math.floor(trip.rating)) + '☆'.repeat(5 - Math.floor(trip.rating));
            const mainImage = Array.isArray(trip.images) ? trip.images[0] : trip.images;
            
            card.innerHTML = `
                ${isAdmin ? `
                <div class="admin-actions">
                    <button class="admin-btn" onclick="event.stopPropagation(); editTrip('${trip.id}')"><i class="fas fa-edit"></i></button>
                    <button class="admin-btn" onclick="event.stopPropagation(); deleteTrip('${trip.id}')"><i class="fas fa-trash"></i></button>
                </div>
                ` : ''}
                <div class="trip-card-image">
                    <img src="${mainImage}" alt="${trip.title}">
                    <div class="trip-badge">${trip.category}</div>
                </div>
                <div class="trip-card-content">
                    <h3>${trip.title}</h3>
                    <div class="trip-location">
                        <i class="fas fa-map-marker-alt"></i>
                        ${trip.location}
                    </div>
                    <div class="trip-rating">
                        <div class="stars">${stars}</div>
                        <span>${trip.rating}</span>
                    </div>
                    <div class="trip-price">
                        <span>${trip.price}</span>
                        <span class="trip-duration">${trip.duration || ''}</span>
                    </div>
                </div>
            `;
            
            return card;
        }

        function openTripModal(trip) {
            currentTripId = trip.id;
            currentTripLocation = trip.location;
            currentTripImages = Array.isArray(trip.images) ? trip.images : [trip.images];
            currentImageIndex = 0;
            
            // Setup image gallery
            setupImageGallery();
            
            // Fill trip details
            document.getElementById('modalTitle').textContent = trip.title;
            document.getElementById('modalLocation').textContent = trip.location;
            document.getElementById('modalDuration').textContent = trip.duration || '';
            document.getElementById('modalRating').textContent = trip.rating;
            document.getElementById('modalPrice').textContent = trip.price;
            document.getElementById('modalDescription').textContent = trip.description;
            
            const stars = '★'.repeat(Math.floor(trip.rating)) + '☆'.repeat(5 - Math.floor(trip.rating));
            document.getElementById('modalStars').textContent = stars;
            
            // Setup requirements
            if (trip.requirements && trip.requirements.length > 0) {
                const requirementsList = document.getElementById('requirementsList');
                requirementsList.innerHTML = '';
                trip.requirements.forEach(req => {
                    const li = document.createElement('li');
                    li.innerHTML = `<i class="fas fa-check"></i> ${req}`;
                    requirementsList.appendChild(li);
                });
                document.getElementById('modalRequirements').style.display = 'block';
            } else {
                document.getElementById('modalRequirements').style.display = 'none';
            }
            
            // Setup video
            if (trip.videoUrl) {
                document.getElementById('modalVideoContainer').style.display = 'block';
                document.getElementById('modalVideo').src = trip.videoUrl;
            } else {
                document.getElementById('modalVideoContainer').style.display = 'none';
            }
            
            // Show admin actions if admin
            if (isAdmin) {
                document.getElementById('modalAdminActions').style.display = 'flex';
            }
            
            // Show reviews only for past trips
            const reviewsSection = document.querySelector('.reviews-section');
            const addReviewBtn = document.getElementById('addReviewBtn');
            
            if (trip.section === 'past') {
                reviewsSection.style.display = 'block';
                addReviewBtn.style.display = 'inline-block';
                loadTripReviews(trip.id);
            } else {
                reviewsSection.style.display = 'none';
                addReviewBtn.style.display = 'none';
            }
            
            document.getElementById('tripModal').style.display = 'flex';
        }

        function setupImageGallery() {
            const gallery = document.getElementById('modalImageGallery');
            const indicators = document.getElementById('imageIndicators');
            
            gallery.innerHTML = '';
            indicators.innerHTML = '';
            
            currentTripImages.forEach((image, index) => {
                // Create image element
                const img = document.createElement('img');
                img.src = image;
                img.className = index === 0 ? 'active' : '';
                gallery.appendChild(img);
                
                // Create indicator
                const indicator = document.createElement('div');
                indicator.className = `indicator ${index === 0 ? 'active' : ''}`;
                indicator.onclick = () => showImage(index);
                indicators.appendChild(indicator);
            });
        }

        function showImage(index) {
            currentImageIndex = index;
            
            // Update images
            document.querySelectorAll('#modalImageGallery img').forEach((img, i) => {
                img.classList.toggle('active', i === index);
            });
            
            // Update indicators
            document.querySelectorAll('.indicator').forEach((indicator, i) => {
                indicator.classList.toggle('active', i === index);
            });
        }

        function previousImage() {
            const newIndex = currentImageIndex > 0 ? currentImageIndex - 1 : currentTripImages.length - 1;
            showImage(newIndex);
        }

        function nextImage() {
            const newIndex = currentImageIndex < currentTripImages.length - 1 ? currentImageIndex + 1 : 0;
            showImage(newIndex);
        }

        async function handleAdminSubmit(e) {
            e.preventDefault();
            
            if (!isAdmin) {
                alert('Access denied. Admin privileges required.');
                return;
            }
            
            const images = document.getElementById('tripImages').value.split('\n').filter(url => url.trim());
            const requirements = document.getElementById('tripRequirements').value.split('\n').filter(req => req.trim());
            
            const tripData = {
                title: document.getElementById('tripTitle').value,
                location: document.getElementById('tripLocation').value,
                duration: document.getElementById('tripDuration').value,
                images: images,
                price: document.getElementById('tripPrice').value,
                rating: parseFloat(document.getElementById('tripRating').value),
                description: document.getElementById('tripDescription').value,
                requirements: requirements,
                videoUrl: document.getElementById('tripVideo').value,
                category: document.getElementById('tripCategory').value,
                section: document.getElementById('tripSection').value,
                createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                createdBy: currentUser.email
            };
            
            document.getElementById('adminLoading').style.display = 'inline-block';
            document.getElementById('adminSubmitText').style.display = 'none';
            
            try {
                // Save to both Firestore and Realtime Database
                await db.collection('trips').add(tripData);
                await database.ref('trips').push(tripData);
                
                document.getElementById('adminForm').reset();
                loadTripsFromFirestore();
                
                sendFreeNotification('Success', 'Trip added successfully!', 'success');
            } catch (error) {
                console.error('Error adding trip:', error);
                sendFreeNotification('Error', 'Failed to add trip: ' + error.message, 'error');
            } finally {
                document.getElementById('adminLoading').style.display = 'none';
                document.getElementById('adminSubmitText').style.display = 'inline';
            }
        }

        async function handleBookingSubmit(e) {
            e.preventDefault();
            
            if (!currentUser) {
                alert('Please login to book a trip.');
                return;
            }

            // Show loading state
            document.getElementById('bookingLoading').style.display = 'inline-block';
            const submitBtn = e.target.querySelector('button[type="submit"]');
            submitBtn.disabled = true;
            
            const bookingData = {
                tripId: currentTripId,
                userId: currentUser.uid,
                userEmail: currentUser.email,
                name: document.getElementById('bookingName').value,
                email: document.getElementById('bookingEmail').value,
                phone: document.getElementById('bookingPhone').value,
                adults: parseInt(document.getElementById('adultCount').value),
                children: parseInt(document.getElementById('childCount').value),
                seniors: parseInt(document.getElementById('seniorCount').value),
                genderMix: document.getElementById('genderMix').value,
                preferredDate: document.getElementById('bookingDate').value,
                specialRequests: document.getElementById('specialRequests').value,
                bookingDate: firebase.database.ServerValue.TIMESTAMP,
                status: 'pending',
                bookingId: 'BK' + Date.now()
            };
            
            try {
                // Save to both Firestore and Realtime Database
                await db.collection('bookings').add(bookingData);
                await database.ref('bookings').push(bookingData);
                
                                // Show success message
                const successDiv = document.createElement('div');
                successDiv.className = 'success-message';
                successDiv.innerHTML = '<i class="fas fa-check-circle"></i> Booking request submitted successfully! Booking ID: ' + bookingData.bookingId + '. We will contact you soon.';
                document.querySelector('.booking-card').insertBefore(successDiv, document.getElementById('bookingForm'));
                
                // Show weather info for destination
                const weather = getSimulatedWeather(currentTripLocation);
                const weatherDiv = document.createElement('div');
                weatherDiv.className = 'weather-info';
                weatherDiv.style.cssText = 'background: #e0f2fe; padding: 1rem; border-radius: 10px; margin: 1rem 0; color: #0277bd;';
                weatherDiv.innerHTML = `
                    <h4><i class="fas fa-cloud-sun"></i> Weather in ${weather.location}</h4>
                    <p>${weather.weather} • ${weather.temperature} • Humidity: ${weather.humidity}</p>
                `;
                document.querySelector('.booking-card').insertBefore(weatherDiv, document.getElementById('bookingForm'));
                
                document.getElementById('bookingForm').reset();
                
                // Send notification using free browser notification
                sendFreeNotification('Booking Confirmed!', `Your booking ${bookingData.bookingId} has been submitted successfully.`);
                
                // Add QR code and print option to success message
                const qrDiv = document.createElement('div');
                qrDiv.className = 'qr-section';
                qrDiv.style.cssText = 'text-align: center; margin: 1rem 0; padding: 1rem; background: white; border-radius: 10px;';
                qrDiv.innerHTML = `
                    <img src="${generateBookingQR(bookingData.bookingId)}" alt="Booking QR Code" style="max-width: 150px;">
                    <p style="margin: 0.5rem 0; color: #666;">Scan QR code for booking details</p>
                    <button class="btn btn-outline" onclick="printBookingDetails('${bookingData.bookingId}')" style="margin: 0.5rem;">
                        <i class="fas fa-print"></i> Print Booking
                    </button>
                    <button class="btn btn-outline" onclick="speakText('Your booking ${bookingData.bookingId} has been confirmed. Thank you for choosing TrekWanders!')" style="margin: 0.5rem;">
                        <i class="fas fa-volume-up"></i> Speak
                    </button>
                `;
                document.querySelector('.booking-card').insertBefore(qrDiv, document.getElementById('bookingForm'));
                
                // Remove success message after 10 seconds
                setTimeout(() => {
                    if (successDiv.parentNode) {
                        successDiv.parentNode.removeChild(successDiv);
                    }
                    if (weatherDiv.parentNode) {
                        weatherDiv.parentNode.removeChild(weatherDiv);
                    }
                    if (qrDiv.parentNode) {
                        qrDiv.parentNode.removeChild(qrDiv);
                    }
                }, 10000);
                
            } catch (error) {
                console.error('Booking error:', error);
                alert('Error submitting booking: ' + error.message);
            } finally {
                // Hide loading state
                document.getElementById('bookingLoading').style.display = 'none';
                submitBtn.disabled = false;
            }
        }

        async function handleReviewSubmit(e) {
            e.preventDefault();
            
            if (!currentUser) {
                alert('Please login to add a review.');
                return;
            }

            // Show loading state
            document.getElementById('reviewLoading').style.display = 'inline-block';
            const submitBtn = e.target.querySelector('button[type="submit"]');
            submitBtn.disabled = true;
            
            const reviewData = {
                tripId: currentTripId,
                userId: currentUser.uid,
                userEmail: currentUser.email,
                userName: currentUser.displayName || currentUser.email.split('@')[0],
                rating: parseInt(document.getElementById('reviewRating').value),
                title: document.getElementById('reviewTitle').value,
                text: document.getElementById('reviewText').value,
                createdAt: firebase.firestore.FieldValue.serverTimestamp()
            };
            
            try {
                // Save to both Firestore and Realtime Database
                await db.collection('reviews').add(reviewData);
                await database.ref('reviews').push(reviewData);
                
                document.getElementById('reviewForm').reset();
                hideAddReviewForm();
                loadTripReviews(currentTripId);
                
                // Show success notification
                sendFreeNotification('Review Added', 'Your review has been posted successfully!', 'success');
                
            } catch (error) {
                console.error('Error adding review:', error);
                sendFreeNotification('Error', 'Failed to add review. Please try again.', 'error');
            } finally {
                // Hide loading state
                document.getElementById('reviewLoading').style.display = 'none';
                submitBtn.disabled = false;
            }
        }

        function showAddReviewForm() {
            if (!currentUser) {
                alert('Please login to add a review.');
                return;
            }
            document.getElementById('addReviewForm').style.display = 'block';
            document.getElementById('addReviewBtn').style.display = 'none';
        }

        function hideAddReviewForm() {
            document.getElementById('addReviewForm').style.display = 'none';
            document.getElementById('addReviewBtn').style.display = 'block';
        }

        async function loadTripReviews(tripId) {
            try {
                const reviews = await db.collection('reviews')
                    .where('tripId', '==', tripId)
                    .orderBy('createdAt', 'desc')
                    .get();
                
                const reviewsList = document.getElementById('reviewsList');
                reviewsList.innerHTML = '';
                
                reviews.forEach(doc => {
                    const review = doc.data();
                    const reviewCard = createReviewCard(review);
                    reviewsList.appendChild(reviewCard);
                });
            } catch (error) {
                console.error('Error loading reviews:', error);
            }
        }

        function createReviewCard(review) {
            const card = document.createElement('div');
            card.className = 'review-card';
            
            const stars = '★'.repeat(review.rating) + '☆'.repeat(5 - review.rating);
            const date = review.createdAt ? review.createdAt.toDate().toLocaleDateString() : 'Recently';
            
            card.innerHTML = `
                <div class="review-header">
                    <div class="reviewer-info">
                        <div class="reviewer-avatar">${review.userName[0].toUpperCase()}</div>
                        <div>
                            <div><strong>${review.userName}</strong></div>
                            <div class="stars">${stars}</div>
                        </div>
                    </div>
                    <div class="review-date">${date}</div>
                </div>
                <h4>${review.title}</h4>
                <p>${review.text}</p>
            `;
            
            return card;
        }

        async function loadTripsFromFirestore() {
            try {
                const snapshot = await db.collection('trips').orderBy('createdAt', 'desc').get();
                
                // Remove Firebase trips from allTrips array
                allTrips = allTrips.filter(trip => trip.id.startsWith('sample'));
                
                // Add Firebase trips
                snapshot.forEach(doc => {
                    const trip = { id: doc.id, ...doc.data() };
                    allTrips.push(trip);
                });
                
                filteredTrips = [...allTrips];
                renderTrips();
            } catch (error) {
                console.error('Error loading trips:', error);
            }
        }

        async function loadUsersList() {
            if (!isAdmin) return;
            
            try {
                const users = await db.collection('users').get();
                const usersList = document.getElementById('usersList');
                usersList.innerHTML = '';
                
                users.forEach(doc => {
                    const user = doc.data();
                    const userCard = createUserCard(doc.id, user);
                    usersList.appendChild(userCard);
                });
            } catch (error) {
                console.error('Error loading users:', error);
            }
        }

        function createUserCard(userId, user) {
            const card = document.createElement('div');
            card.className = 'review-card';
            
            card.innerHTML = `
                <div class="review-header">
                    <div class="reviewer-info">
                        <div class="reviewer-avatar">${user.email[0].toUpperCase()}</div>
                        <div>
                            <div><strong>${user.email}</strong></div>
                            <div class="role-badge ${user.role === 'admin' ? 'admin' : ''}">${user.role}</div>
                        </div>
                    </div>
                    <div>
                        <select onchange="changeUserRole('${userId}', this.value)">
                            <option value="user" ${user.role === 'user' ? 'selected' : ''}>User</option>
                            <option value="admin" ${user.role === 'admin' ? 'selected' : ''}>Admin</option>
                        </select>
                    </div>
                </div>
            `;
            
            return card;
        }

        async function changeUserRole(userId, newRole) {
            if (!isAdmin) return;
            
            try {
                await db.collection('users').doc(userId).update({
                    role: newRole
                });
                alert('User role updated successfully!');
            } catch (error) {
                alert('Error updating user role: ' + error.message);
            }
        }

        async function deleteTrip(tripId) {
            if (!isAdmin || !confirm('Are you sure you want to delete this trip?')) return;
            
            try {
                await db.collection('trips').doc(tripId).delete();
                // Remove from local array
                allTrips = allTrips.filter(trip => trip.id !== tripId);
                filteredTrips = filteredTrips.filter(trip => trip.id !== tripId);
                renderTrips();
                document.getElementById('tripModal').style.display = 'none';
                alert('Trip deleted successfully!');
            } catch (error) {
                alert('Error deleting trip: ' + error.message);
            }
        }

        function editTrip(tripId) {
            if (!isAdmin) return;
            alert('Edit functionality would be implemented here. For now, please delete and recreate the trip.');
        }

        // Feed Functions
        function loadSampleFeedPosts() {
            const samplePosts = [
                {
                    id: 'sample-post-1',
                    title: 'Welcome to TrekWanders!',
                    content: 'We are excited to launch our new travel platform. Explore amazing destinations and create unforgettable memories with us. Our team is dedicated to providing you with the best travel experiences around the world.',
                    imageUrl: 'https://images.unsplash.com/photo-1488646953014-85cb44e25828?w=600&h=300&fit=crop',
                    authorName: 'TrekWanders Team',
                    authorEmail: 'admin@trekwanders.com',
                    createdAt: new Date(),
                    likes: 24
                },
                {
                    id: 'sample-post-2',
                    title: 'New Himalayan Trek Routes Available',
                    content: 'We have added exciting new trekking routes in the Himalayas. These carefully curated paths offer breathtaking views and authentic cultural experiences. Book your adventure today!',
                    imageUrl: 'https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=600&h=300&fit=crop',
                    authorName: 'Adventure Team',
                    authorEmail: 'admin@trekwanders.com',
                    createdAt: new Date(Date.now() - 86400000), // 1 day ago
                    likes: 18
                }
            ];

            renderFeedPosts(samplePosts);
        }

        function renderFeedPosts(posts) {
            const feedContainer = document.getElementById('feedPosts');
            feedContainer.innerHTML = '';

            posts.forEach(post => {
                const postElement = createFeedPostElement(post);
                feedContainer.appendChild(postElement);
            });
        }

        function createFeedPostElement(post) {
            const postDiv = document.createElement('div');
            postDiv.className = 'feed-post';
            
            const createdDate = post.createdAt instanceof Date ? post.createdAt : (post.createdAt ? post.createdAt.toDate() : new Date());
            const timeAgo = getTimeAgo(createdDate);
            const currentRating = post.userRating || 0;
            const averageRating = post.averageRating || 0;
            const totalRatings = post.totalRatings || 0;

            postDiv.innerHTML = `
                <div class="post-header">
                    <div class="post-avatar">${post.authorName[0].toUpperCase()}</div>
                    <div class="post-info">
                        <h4>${post.authorName}</h4>
                        <div class="post-date">${timeAgo}</div>
                    </div>
                </div>
                <div class="post-content">
                    <h3>${post.title}</h3>
                    <p>${post.content}</p>
                    ${post.imageUrl ? `<img src="${post.imageUrl}" alt="Post image" class="post-image">` : ''}
                </div>
                <div class="post-rating">
                    <div class="rating-section">
                        <span style="margin-right: 1rem;">Rate this post:</span>
                        <div class="star-rating" data-post-id="${post.id}">
                            ${[1,2,3,4,5].map(star => `
                                <span class="star ${star <= currentRating ? 'active' : ''}" 
                                      onclick="ratePost('${post.id}', ${star})">★</span>
                            `).join('')}
                        </div>
                    </div>
                    <div class="rating-display">
                        <span class="rating-stats">
                            ${averageRating > 0 ? `${averageRating.toFixed(1)} ★ (${totalRatings} ratings)` : 'No ratings yet'}
                        </span>
                    </div>
                </div>
            `;

            return postDiv;
        }

        function getTimeAgo(date) {
            const now = new Date();
            const diffInSeconds = Math.floor((now - date) / 1000);
            
            if (diffInSeconds < 60) return 'Just now';
            if (diffInSeconds < 3600) return `${Math.floor(diffInSeconds / 60)} minutes ago`;
            if (diffInSeconds < 86400) return `${Math.floor(diffInSeconds / 3600)} hours ago`;
            if (diffInSeconds < 604800) return `${Math.floor(diffInSeconds / 86400)} days ago`;
            
            return date.toLocaleDateString();
        }

        function showAddPostForm() {
            if (!isAdmin) {
                alert('Only admins can create posts.');
                return;
            }
            document.getElementById('addPostForm').style.display = 'block';
            document.getElementById('addPostBtn').style.display = 'none';
        }

        function hideAddPostForm() {
            document.getElementById('addPostForm').style.display = 'none';
            document.getElementById('addPostBtn').style.display = 'inline-block';
        }

        async function handleFeedPostSubmit(e) {
            e.preventDefault();
            
            if (!isAdmin) {
                alert('Only admins can create posts.');
                return;
            }

            const postData = {
                title: document.getElementById('postTitle').value,
                content: document.getElementById('postContent').value,
                imageUrl: document.getElementById('postImage').value,
                authorName: currentUser.displayName || currentUser.email.split('@')[0],
                authorEmail: currentUser.email,
                authorId: currentUser.uid,
                createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                likes: 0
            };

            try {
                await db.collection('feed').add(postData);
                document.getElementById('feedPostForm').reset();
                hideAddPostForm();
                loadFeedPosts();
                
                // Show success message
                const successDiv = document.createElement('div');
                successDiv.className = 'success-message';
                successDiv.innerHTML = '<i class="fas fa-check-circle"></i> Post created successfully!';
                document.querySelector('.feed-section .container').insertBefore(successDiv, document.getElementById('feedPosts'));
                
                setTimeout(() => {
                    if (successDiv.parentNode) {
                        successDiv.parentNode.removeChild(successDiv);
                    }
                }, 3000);
                
            } catch (error) {
                alert('Error creating post: ' + error.message);
            }
        }

        // Enhanced Feed Loading with Pagination (Material 3 Design)
        let feedPostsSnapshot = null;
        let feedPagination = { limit: 6, lastDoc: null, hasMore: true };

        async function loadFeedPosts(reset = false) {
            try {
                if (reset) {
                    feedPagination = { limit: 6, lastDoc: null, hasMore: true };
                }

                let query = db.collection('feed').orderBy('createdAt', 'desc').limit(feedPagination.limit);
                
                if (feedPagination.lastDoc) {
                    query = query.startAfter(feedPagination.lastDoc);
                }

                const snapshot = await query.get();
                const posts = [];
                
                snapshot.forEach(doc => {
                    posts.push({ id: doc.id, ...doc.data() });
                });

                if (snapshot.docs.length > 0) {
                    feedPagination.lastDoc = snapshot.docs[snapshot.docs.length - 1];
                    feedPagination.hasMore = snapshot.docs.length === feedPagination.limit;
                } else {
                    feedPagination.hasMore = false;
                }

                renderFeedPosts(posts, reset);
                
                // Show/hide "Load More" button
                const loadMoreBtn = document.getElementById('loadMoreFeed');
                if (loadMoreBtn) {
                    loadMoreBtn.style.display = feedPagination.hasMore ? 'block' : 'none';
                }

            } catch (error) {
                console.error('Error loading feed posts:', error);
                // Load sample posts if Firebase fails
                if (reset) loadSampleFeedPosts();
            }
        }

        async function likePost(postId) {
            if (!currentUser) {
                Swal.fire({
                    icon: 'warning',
                    title: 'Login Required',
                    text: 'Please login to like posts.',
                    confirmButtonColor: '#2563eb'
                });
                return;
            }
            
            try {
                const likeRef = database.ref('likes/' + postId + '/' + currentUser.uid);
                const snapshot = await likeRef.once('value');
                
                if (snapshot.exists()) {
                    // Unlike the post
                    await likeRef.remove();
                    await database.ref('feed/' + postId + '/likes').transaction(current => (current || 1) - 1);
                } else {
                    // Like the post
                    await likeRef.set({
                        userId: currentUser.uid,
                        userEmail: currentUser.email,
                        timestamp: firebase.database.ServerValue.TIMESTAMP
                    });
                    await database.ref('feed/' + postId + '/likes').transaction(current => (current || 0) + 1);
                }
                
                // Reload feed to update like counts
                loadFeedPosts();
                
            } catch (error) {
                console.error('Error liking post:', error);
                Swal.fire({
                    icon: 'error',
                    title: 'Error',
                    text: 'Failed to like post. Please try again.',
                    confirmButtonColor: '#2563eb'
                });
            }
        }

        // Free notification system using browser notifications and Toastify
        function sendFreeNotification(title, message, type = 'success') {
            // Browser notification (free and unlimited)
            if ('Notification' in window) {
                if (Notification.permission === 'granted') {
                    new Notification(title, {
                        body: message,
                        icon: 'https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=64&h=64&fit=crop'
                    });
                } else if (Notification.permission !== 'denied') {
                    Notification.requestPermission().then(permission => {
                        if (permission === 'granted') {
                            new Notification(title, {
                                body: message,
                                icon: 'https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=64&h=64&fit=crop'
                            });
                        }
                    });
                }
            }
            
            // Toastify notification (free and unlimited)
            Toastify({
                text: `${title}: ${message}`,
                duration: 5000,
                gravity: "top",
                position: "right",
                backgroundColor: type === 'success' ? "#10b981" : type === 'error' ? "#ef4444" : "#2563eb",
                stopOnFocus: true,
                onClick: function(){}
            }).showToast();
        }

        // Free weather simulation (no API required)
        function getSimulatedWeather(location) {
            const weatherTypes = ['Sunny', 'Cloudy', 'Rainy', 'Partly Cloudy', 'Clear'];
            const temperatures = [15, 18, 22, 25, 28, 30, 32];
            
            return {
                location: location,
                weather: weatherTypes[Math.floor(Math.random() * weatherTypes.length)],
                temperature: temperatures[Math.floor(Math.random() * temperatures.length)] + '°C',
                humidity: Math.floor(Math.random() * 40) + 40 + '%',
                windSpeed: Math.floor(Math.random() * 15) + 5 + ' km/h'
            };
        }

        // Free currency conversion simulation (no API required)
        function simulateCurrencyConversion(amount, fromCurrency = 'USD', toCurrency = 'EUR') {
            const exchangeRates = {
                'USD': { 'EUR': 0.85, 'GBP': 0.73, 'JPY': 110, 'INR': 75, 'CAD': 1.25 },
                'EUR': { 'USD': 1.18, 'GBP': 0.86, 'JPY': 130, 'INR': 88, 'CAD': 1.47 },
                'GBP': { 'USD': 1.37, 'EUR': 1.16, 'JPY': 151, 'INR': 102, 'CAD': 1.71 }
            };
            
            if (exchangeRates[fromCurrency] && exchangeRates[fromCurrency][toCurrency]) {
                const convertedAmount = (amount * exchangeRates[fromCurrency][toCurrency]).toFixed(2);
                return { amount: convertedAmount, currency: toCurrency, rate: exchangeRates[fromCurrency][toCurrency] };
            }
            
            return { amount: amount, currency: fromCurrency, rate: 1 };
        }

        // Free location services using browser geolocation
        function getUserLocation() {
            return new Promise((resolve, reject) => {
                if ('geolocation' in navigator) {
                    navigator.geolocation.getCurrentPosition(
                        position => {
                            resolve({
                                latitude: position.coords.latitude,
                                longitude: position.coords.longitude,
                                accuracy: position.coords.accuracy
                            });
                        },
                        error => reject(error),
                        {
                            enableHighAccuracy: true,
                            timeout: 10000,
                            maximumAge: 600000
                        }
                    );
                } else {
                    reject(new Error('Geolocation not supported'));
                }
            });
        }

        // Enhanced user role management
        async function changeUserRole(userId, newRole) {
            if (!isAdmin) {
                Swal.fire({
                    icon: 'error',
                    title: 'Access Denied',
                    text: 'Only admins can change user roles.',
                    confirmButtonColor: '#2563eb'
                });
                return;
            }
            
            try {
                await database.ref('users/' + userId + '/role').set(newRole);
                
                Swal.fire({
                    icon: 'success',
                    title: 'Success!',
                    text: 'User role updated successfully!',
                    confirmButtonColor: '#2563eb'
                });
                
                loadUsersList();
            } catch (error) {
                console.error('Error updating user role:', error);
                Swal.fire({
                    icon: 'error',
                    title: 'Error',
                    text: 'Failed to update user role: ' + error.message,
                    confirmButtonColor: '#2563eb'
                });
            }
                 }

         // Free utility functions (no API required)
         
         // Generate QR Code for bookings (free library)
         function generateBookingQR(bookingId) {
             const qrData = `TrekWanders Booking: ${bookingId}`;
             const qrUrl = `https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${encodeURIComponent(qrData)}`;
             return qrUrl;
         }

         // Free image optimization
         function optimizeImageUrl(url, width = 800, height = 600) {
             if (url.includes('unsplash.com')) {
                 return `${url}?w=${width}&h=${height}&fit=crop&crop=center`;
             }
             return url;
         }

         // Local storage for offline functionality
         function saveToLocalStorage(key, data) {
             try {
                 localStorage.setItem(key, JSON.stringify(data));
                 return true;
             } catch (error) {
                 console.error('Failed to save to localStorage:', error);
                 return false;
             }
         }

         function getFromLocalStorage(key) {
             try {
                 const data = localStorage.getItem(key);
                 return data ? JSON.parse(data) : null;
             } catch (error) {
                 console.error('Failed to get from localStorage:', error);
                 return null;
             }
         }

         // Free text-to-speech functionality
         function speakText(text) {
             if ('speechSynthesis' in window) {
                 const utterance = new SpeechSynthesisUtterance(text);
                 utterance.rate = 0.8;
                 utterance.pitch = 1;
                 utterance.volume = 0.8;
                 speechSynthesis.speak(utterance);
             }
         }

         // Free image gallery with keyboard navigation
         function initImageGallery() {
             document.addEventListener('keydown', function(e) {
                 if (document.getElementById('tripModal').style.display === 'flex') {
                     if (e.key === 'ArrowLeft') {
                         previousImage();
                     } else if (e.key === 'ArrowRight') {
                         nextImage();
                     } else if (e.key === 'Escape') {
                         document.getElementById('tripModal').style.display = 'none';
                     }
                 }
             });
         }

         // Free print functionality
         function printBookingDetails(bookingId) {
             const printWindow = window.open('', '_blank');
             printWindow.document.write(`
                 <html>
                 <head>
                     <title>TrekWanders Booking - ${bookingId}</title>
                     <style>
                         body { font-family: Arial, sans-serif; padding: 20px; }
                         .header { text-align: center; margin-bottom: 30px; }
                         .booking-details { border: 1px solid #ddd; padding: 20px; border-radius: 10px; }
                         .qr-code { text-align: center; margin-top: 20px; }
                     </style>
                 </head>
                 <body>
                     <div class="header">
                         <h1>TrekWanders</h1>
                         <h2>Booking Confirmation</h2>
                     </div>
                     <div class="booking-details">
                         <h3>Booking ID: ${bookingId}</h3>
                         <p>Thank you for booking with TrekWanders!</p>
                         <p>Date: ${new Date().toLocaleDateString()}</p>
                         <div class="qr-code">
                             <img src="${generateBookingQR(bookingId)}" alt="Booking QR Code">
                             <p>Scan this QR code for quick access to your booking</p>
                         </div>
                     </div>
                 </body>
                 </html>
             `);
             printWindow.document.close();
             printWindow.print();
         }

         // Hero search function
         function searchTrips() {
             const location = document.getElementById('heroSearchInput').value;
             const date = document.getElementById('heroDateInput').value;
             
             if (location) {
                 // Filter trips by location
                 filteredTrips = allTrips.filter(trip => 
                     trip.location.toLowerCase().includes(location.toLowerCase()) ||
                     trip.title.toLowerCase().includes(location.toLowerCase())
                 );
                 renderTrips();
                 document.getElementById('destinations').scrollIntoView();
                 sendFreeNotification('Search Results', `Found ${filteredTrips.length} trips for "${location}"`, 'info');
             } else {
                 sendFreeNotification('Search Error', 'Please enter a destination to search', 'error');
             }
         }

         // Initialize free features
         function initializeFreeFeatures() {
             // Initialize image gallery
             initImageGallery();
             
             // Add keyboard shortcuts
             document.addEventListener('keydown', function(e) {
                 if (e.ctrlKey || e.metaKey) {
                     switch(e.key) {
                         case 's':
                             e.preventDefault();
                             if (currentUser && isAdmin) {
                                 document.getElementById('adminPanel').scrollIntoView();
                             }
                             break;
                     }
                 }
             });
         }

         // Smooth scrolling for navigation
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });

        // === NEW ENHANCED FEATURES ===

        // Hero Image Management
        function initializeHeroImages() {
            // Amazing travel hero images that auto-change
            heroImages = [
                'https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=1920&h=1080&fit=crop&crop=center', // Mountain landscape
                'https://images.unsplash.com/photo-1441974231531-c6227db76b6e?w=1920&h=1080&fit=crop&crop=center', // Forest path
                'https://images.unsplash.com/photo-1506197603052-3cc9c3a201bd?w=1920&h=1080&fit=crop&crop=center', // Ocean sunset
                'https://images.unsplash.com/photo-1454391304352-2bf4678b1a7a?w=1920&h=1080&fit=crop&crop=center', // Desert landscape
                'https://images.unsplash.com/photo-1464822759844-d150baec3e5d?w=1920&h=1080&fit=crop&crop=center', // Mountain lake
                'https://images.unsplash.com/photo-1571863533956-01c88e79957e?w=1920&h=1080&fit=crop&crop=center', // Himalayan peaks
                'https://images.unsplash.com/photo-1544735716-392fe2489ffa?w=1920&h=1080&fit=crop&crop=center', // Mountain valley
                'https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=1920&h=1080&fit=crop&crop=center', // Adventure scene
                'https://images.unsplash.com/photo-1469474968028-56623f02e42e?w=1920&h=1080&fit=crop&crop=center', // Beach paradise
                'https://images.unsplash.com/photo-1504893524553-b855bce32c67?w=1920&h=1080&fit=crop&crop=center'  // Travel destination
            ];
            
            loadHeroImages();
            startHeroImageRotation();
            
            // Load admin hero images if admin
            if (isAdmin) {
                loadAdminHeroImages();
            }
        }

        function loadHeroImages() {
            const heroBackground = document.getElementById('heroBackground');
            if (!heroBackground) {
                console.error('Hero background element not found');
                return;
            }
            
            heroBackground.innerHTML = '';
            
            heroImages.forEach((imageUrl, index) => {
                const img = document.createElement('img');
                img.src = imageUrl;
                img.className = index === 0 ? 'active' : '';
                img.alt = `Hero Background ${index + 1}`;
                img.onerror = function() {
                    console.warn(`Failed to load hero image: ${imageUrl}`);
                };
                heroBackground.appendChild(img);
            });
            
            console.log(`Loaded ${heroImages.length} hero images`);
        }

        function startHeroImageRotation() {
            if (heroImageInterval) {
                clearInterval(heroImageInterval);
            }
            
            heroImageInterval = setInterval(() => {
                if (heroImages.length > 1) {
                    currentHeroImageIndex = (currentHeroImageIndex + 1) % heroImages.length;
                    updateHeroImage();
                }
            }, 5000); // Change every 5 seconds
        }

        function updateHeroImage() {
            const images = document.querySelectorAll('#heroBackground img');
            images.forEach((img, index) => {
                img.classList.toggle('active', index === currentHeroImageIndex);
            });
        }

        // Image Upload Functions using Firebase Storage (Recommended)
        async function uploadToFreeService(file) {
            try {
                // Method 1: Firebase Storage (Most Reliable)
                if (typeof firebase !== 'undefined' && firebase.storage) {
                    return await uploadToFirebaseStorage(file);
                }
                
                // Method 2: ImgBB (Free with API key)
                if (window.IMGBB_API_KEY) {
                    return await uploadToImgBB(file);
                }
                
                // Method 3: Cloudinary (Professional)
                if (window.CLOUDINARY_CONFIG) {
                    return await uploadToCloudinary(file);
                }
                
                // Method 4: PostImages.org (Free, no API key)
                return await uploadToPostImages(file);
                
            } catch (error) {
                console.error('Upload failed:', error);
                // Fallback to base64 for immediate preview
                return await convertToBase64(file);
            }
        }

        // Firebase Storage Upload (Primary Method)
        async function uploadToFirebaseStorage(file) {
            try {
                const storageRef = firebase.storage().ref();
                const timestamp = Date.now();
                const fileName = `${timestamp}_${file.name.replace(/[^a-zA-Z0-9.]/g, '_')}`;
                const imageRef = storageRef.child(`images/${fileName}`);
                
                // Show upload progress
                const uploadTask = imageRef.put(file);
                
                return new Promise((resolve, reject) => {
                    uploadTask.on('state_changed',
                        (snapshot) => {
                            // Progress monitoring
                            const progress = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;
                            console.log('Upload progress:', progress + '%');
                        },
                        (error) => {
                            console.error('Firebase upload error:', error);
                            reject(error);
                        },
                        async () => {
                            // Upload completed successfully
                            try {
                                const downloadURL = await uploadTask.snapshot.ref.getDownloadURL();
                                console.log('✅ Image uploaded to Firebase Storage:', downloadURL);
                                resolve(downloadURL);
                            } catch (error) {
                                reject(error);
                            }
                        }
                    );
                });
            } catch (error) {
                console.error('Firebase Storage upload failed:', error);
                throw error;
            }
        }

        // ImgBB Upload (Backup Method 1)
        async function uploadToImgBB(file) {
            try {
                const formData = new FormData();
                formData.append('image', file);
                
                const response = await fetch(`https://api.imgbb.com/1/upload?key=${window.IMGBB_API_KEY}`, {
                    method: 'POST',
                    body: formData
                });
                
                if (!response.ok) throw new Error('ImgBB upload failed');
                
                const data = await response.json();
                if (data.success) {
                    console.log('✅ Image uploaded to ImgBB:', data.data.url);
                    return data.data.url;
                } else {
                    throw new Error('ImgBB API error');
                }
            } catch (error) {
                console.error('ImgBB upload failed:', error);
                throw error;
            }
        }

        // Cloudinary Upload (Backup Method 2)
        async function uploadToCloudinary(file) {
            try {
                const formData = new FormData();
                formData.append('file', file);
                formData.append('upload_preset', window.CLOUDINARY_CONFIG.uploadPreset);
                
                const response = await fetch(`https://api.cloudinary.com/v1_1/${window.CLOUDINARY_CONFIG.cloudName}/image/upload`, {
                    method: 'POST',
                    body: formData
                });
                
                if (!response.ok) throw new Error('Cloudinary upload failed');
                
                const data = await response.json();
                console.log('✅ Image uploaded to Cloudinary:', data.secure_url);
                return data.secure_url;
            } catch (error) {
                console.error('Cloudinary upload failed:', error);
                throw error;
            }
        }

        // PostImages Upload (Backup Method 3)
        async function uploadToPostImages(file) {
            try {
                const formData = new FormData();
                formData.append('upload', file);
                formData.append('action', 'upload');
                
                const response = await fetch('https://postimages.org/json/rr', {
                    method: 'POST',
                    body: formData
                });
                
                if (response.ok) {
                    const data = await response.json();
                    if (data.status === 'OK') {
                        console.log('✅ Image uploaded to PostImages:', data.url);
                        return data.url;
                    }
                }
                throw new Error('PostImages upload failed');
            } catch (error) {
                console.error('PostImages upload failed:', error);
                throw error;
            }
        }

        // Base64 Conversion (Final Fallback)
        async function convertToBase64(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = () => {
                    console.log('⚠️ Using Base64 fallback for image');
                    resolve(reader.result);
                };
                reader.onerror = reject;
                reader.readAsDataURL(file);
            });
        }

        async function handleTripImageUpload(event) {
            const files = event.target.files;
            if (!files.length) return;
            
            const preview = document.getElementById('tripImagePreview');
            const textarea = document.getElementById('tripImages');
            const urls = textarea.value.split('\n').filter(url => url.trim());
            
            try {
                for (let file of files) {
                    // Show loading state
                    const loadingDiv = document.createElement('div');
                    loadingDiv.innerHTML = '<i class="loading"></i> Uploading...';
                    preview.appendChild(loadingDiv);
                    
                    // Upload to free service
                    const url = await uploadToFreeService(file);
                    urls.push(url);
                    
                    // Remove loading and add preview
                    preview.removeChild(loadingDiv);
                    const img = document.createElement('img');
                    img.src = url;
                    img.style.maxWidth = '150px';
                    img.style.borderRadius = '10px';
                    preview.appendChild(img);
                }
                
                textarea.value = urls.join('\n');
                sendFreeNotification('Success', 'Images uploaded successfully!', 'success');
            } catch (error) {
                sendFreeNotification('Error', 'Failed to upload images: ' + error.message, 'error');
            }
        }

        async function handleHeroImageUpload(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            try {
                const url = await uploadToFreeService(file);
                addHeroImage(url);
                sendFreeNotification('Success', 'Hero image uploaded successfully!', 'success');
            } catch (error) {
                sendFreeNotification('Error', 'Failed to upload hero image: ' + error.message, 'error');
            }
        }

        function addHeroImageFromUrl() {
            const url = document.getElementById('heroImageUrl').value.trim();
            if (!url) {
                sendFreeNotification('Error', 'Please enter a valid image URL', 'error');
                return;
            }
            
            addHeroImage(url);
            document.getElementById('heroImageUrl').value = '';
            sendFreeNotification('Success', 'Hero image added successfully!', 'success');
        }

        async function addHeroImage(imageUrl) {
            if (!isAdmin) return;
            
            heroImages.push(imageUrl);
            
            try {
                // Save to Firebase
                await database.ref('heroImages').push({
                    url: imageUrl,
                    addedBy: currentUser.email,
                    addedAt: firebase.database.ServerValue.TIMESTAMP
                });
                
                loadHeroImages();
                loadAdminHeroImages();
                startHeroImageRotation();
            } catch (error) {
                console.error('Error saving hero image:', error);
            }
        }

        async function loadAdminHeroImages() {
            if (!isAdmin) return;
            
            try {
                const snapshot = await database.ref('heroImages').once('value');
                const grid = document.getElementById('heroImagesGrid');
                grid.innerHTML = '';
                
                if (snapshot.exists()) {
                    const images = [];
                    snapshot.forEach(child => {
                        images.push({ id: child.key, ...child.val() });
                    });
                    
                    images.forEach(image => {
                        const imageDiv = createHeroImageItem(image);
                        grid.appendChild(imageDiv);
                    });
                }
                
                // Add default images to the grid
                heroImages.forEach((url, index) => {
                    if (index < 5) { // Show first 5 default images
                        const imageDiv = createHeroImageItem({ 
                            url: url, 
                            id: 'default-' + index,
                            addedBy: 'System',
                            isDefault: true 
                        });
                        grid.appendChild(imageDiv);
                    }
                });
                
            } catch (error) {
                console.error('Error loading admin hero images:', error);
            }
        }

        function createHeroImageItem(image) {
            const div = document.createElement('div');
            div.className = 'hero-image-item';
            
            div.innerHTML = `
                <img src="${image.url}" alt="Hero Image">
                <div class="hero-image-actions">
                    ${!image.isDefault ? `<button class="hero-image-btn" onclick="deleteHeroImage('${image.id}')">
                        <i class="fas fa-trash"></i>
                    </button>` : ''}
                    <button class="hero-image-btn" onclick="setAsMainHeroImage('${image.url}')">
                        <i class="fas fa-star"></i>
                    </button>
                </div>
            `;
            
            return div;
        }

        async function deleteHeroImage(imageId) {
            if (!isAdmin || !confirm('Delete this hero image?')) return;
            
            try {
                await database.ref('heroImages/' + imageId).remove();
                loadAdminHeroImages();
                sendFreeNotification('Success', 'Hero image deleted successfully!', 'success');
            } catch (error) {
                sendFreeNotification('Error', 'Failed to delete hero image', 'error');
            }
        }

        function setAsMainHeroImage(imageUrl) {
            const index = heroImages.indexOf(imageUrl);
            if (index !== -1) {
                currentHeroImageIndex = index;
                updateHeroImage();
                sendFreeNotification('Success', 'Set as main hero image!', 'success');
            }
        }

        // === FOOTER & SOCIAL MEDIA MANAGEMENT ===
        async function updateContactInfo() {
            if (!isAdmin) {
                sendFreeNotification('Error', 'Admin access required', 'error');
                return;
            }

            const contactData = {
                email: document.getElementById('adminContactEmail').value || 'info@trekwanders.com',
                phone: document.getElementById('adminContactPhone').value || '+91 98765 43210',
                address: document.getElementById('adminContactAddress').value || 'Mumbai, Maharashtra, India',
                updatedAt: firebase.database.ServerValue.TIMESTAMP
            };

            try {
                await database.ref('siteSettings/contact').set(contactData);
                updateFooterDisplay();
                sendFreeNotification('Success', 'Contact information updated successfully!', 'success');
            } catch (error) {
                console.error('Error updating contact info:', error);
                sendFreeNotification('Error', 'Failed to update contact info: ' + error.message, 'error');
            }
        }

        async function updateSocialLinks() {
            if (!isAdmin) {
                sendFreeNotification('Error', 'Admin access required', 'error');
                return;
            }

            const socialData = {
                facebook: document.getElementById('adminFacebookLink').value || 'https://facebook.com/trekwanders',
                twitter: document.getElementById('adminTwitterLink').value || 'https://twitter.com/trekwanders',
                instagram: document.getElementById('adminInstagramLink').value || 'https://instagram.com/trekwanders',
                linkedin: document.getElementById('adminLinkedinLink').value || 'https://linkedin.com/company/trekwanders',
                youtube: document.getElementById('adminYoutubeLink').value || 'https://youtube.com/trekwanders',
                updatedAt: firebase.database.ServerValue.TIMESTAMP
            };

            try {
                await database.ref('siteSettings/social').set(socialData);
                updateFooterDisplay();
                sendFreeNotification('Success', 'Social media links updated successfully!', 'success');
            } catch (error) {
                console.error('Error updating social links:', error);
                sendFreeNotification('Error', 'Failed to update social links: ' + error.message, 'error');
            }
        }

        async function loadFooterSettings() {
            try {
                // Load contact info
                const contactSnapshot = await database.ref('siteSettings/contact').once('value');
                const contactData = contactSnapshot.val();
                
                if (contactData) {
                    document.getElementById('adminContactEmail').value = contactData.email || '';
                    document.getElementById('adminContactPhone').value = contactData.phone || '';
                    document.getElementById('adminContactAddress').value = contactData.address || '';
                }

                // Load social links
                const socialSnapshot = await database.ref('siteSettings/social').once('value');
                const socialData = socialSnapshot.val();
                
                if (socialData) {
                    document.getElementById('adminFacebookLink').value = socialData.facebook || '';
                    document.getElementById('adminTwitterLink').value = socialData.twitter || '';
                    document.getElementById('adminInstagramLink').value = socialData.instagram || '';
                    document.getElementById('adminLinkedinLink').value = socialData.linkedin || '';
                    document.getElementById('adminYoutubeLink').value = socialData.youtube || '';
                }

                updateFooterDisplay();
            } catch (error) {
                console.error('Error loading footer settings:', error);
            }
        }

        function updateFooterDisplay() {
            // Update contact info in footer
            const email = document.getElementById('adminContactEmail').value || 'info@trekwanders.com';
            const phone = document.getElementById('adminContactPhone').value || '+91 98765 43210';
            const address = document.getElementById('adminContactAddress').value || 'Mumbai, Maharashtra, India';

            document.getElementById('contactEmail').textContent = email;
            document.getElementById('contactPhone').textContent = phone;
            document.getElementById('contactAddress').textContent = address;

            // Update social links in footer
            const facebook = document.getElementById('adminFacebookLink').value || '#';
            const twitter = document.getElementById('adminTwitterLink').value || '#';
            const instagram = document.getElementById('adminInstagramLink').value || '#';
            const linkedin = document.getElementById('adminLinkedinLink').value || '#';
            const youtube = document.getElementById('adminYoutubeLink').value || '#';

            document.getElementById('facebookLink').href = facebook;
            document.getElementById('twitterLink').href = twitter;
            document.getElementById('instagramLink').href = instagram;
            document.getElementById('linkedinLink').href = linkedin;
            document.getElementById('youtubeLink').href = youtube;
        }

        // === ADMIN FEED POST MANAGEMENT ===
        async function editFeedPost(postId) {
            if (!isAdmin) {
                sendFreeNotification('Error', 'Admin access required', 'error');
                return;
            }

            try {
                const doc = await db.collection('feed').doc(postId).get();
                if (!doc.exists) {
                    sendFreeNotification('Error', 'Post not found', 'error');
                    return;
                }

                const post = doc.data();
                
                const { value: formValues } = await Swal.fire({
                    title: '<i class="fas fa-edit"></i> Edit Feed Post',
                    html: `
                        <div class="swal-form">
                            <div class="form-group">
                                <label>Title</label>
                                <input id="editPostTitle" class="swal2-input" value="${post.title}" placeholder="Post title">
                            </div>
                            <div class="form-group">
                                <label>Content</label>
                                <textarea id="editPostContent" class="swal2-textarea" placeholder="Post content">${post.content}</textarea>
                            </div>
                            <div class="form-group">
                                <label>Image URL (optional)</label>
                                <input id="editPostImage" class="swal2-input" value="${post.imageUrl || ''}" placeholder="Image URL">
                            </div>
                            <div class="form-group">
                                <label>Video URL (optional)</label>
                                <input id="editPostVideo" class="swal2-input" value="${post.videoUrl || ''}" placeholder="YouTube video URL">
                            </div>
                        </div>
                    `,
                    focusConfirm: false,
                    showCancelButton: true,
                    confirmButtonText: '<i class="fas fa-save"></i> Update Post',
                    cancelButtonText: '<i class="fas fa-times"></i> Cancel',
                    confirmButtonColor: '#2563eb',
                    preConfirm: () => {
                        return {
                            title: document.getElementById('editPostTitle').value,
                            content: document.getElementById('editPostContent').value,
                            imageUrl: document.getElementById('editPostImage').value,
                            videoUrl: document.getElementById('editPostVideo').value
                        }
                    }
                });

                if (formValues) {
                    const updatedPost = {
                        ...post,
                        title: formValues.title || post.title,
                        content: formValues.content || post.content,
                        imageUrl: formValues.imageUrl || post.imageUrl || '',
                        videoUrl: formValues.videoUrl || post.videoUrl || '',
                        updatedAt: firebase.firestore.FieldValue.serverTimestamp()
                    };

                    await db.collection('feed').doc(postId).update(updatedPost);
                    await database.ref('feed/' + postId).update(updatedPost);
                    
                    loadFeedPosts(true);
                    sendFreeNotification('Success', 'Post updated successfully!', 'success');
                }
            } catch (error) {
                console.error('Error editing post:', error);
                sendFreeNotification('Error', 'Failed to edit post: ' + error.message, 'error');
            }
        }

        async function deleteFeedPost(postId) {
            if (!isAdmin) {
                sendFreeNotification('Error', 'Admin access required', 'error');
                return;
            }

            const result = await Swal.fire({
                title: '<i class="fas fa-trash"></i> Delete Post?',
                text: 'This action cannot be undone!',
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#dc3545',
                cancelButtonColor: '#6c757d',
                confirmButtonText: '<i class="fas fa-trash"></i> Yes, Delete',
                cancelButtonText: '<i class="fas fa-times"></i> Cancel'
            });

            if (result.isConfirmed) {
                try {
                    await db.collection('feed').doc(postId).delete();
                    await database.ref('feed/' + postId).remove();
                    
                    loadFeedPosts(true);
                    sendFreeNotification('Success', 'Post deleted successfully!', 'success');
                } catch (error) {
                    console.error('Error deleting post:', error);
                    sendFreeNotification('Error', 'Failed to delete post: ' + error.message, 'error');
                }
            }
        }

        // Enhanced Booking Form Submit (Fixed)
        async function handleBookingSubmit(e) {
            e.preventDefault();
            
            if (!currentUser) {
                Swal.fire({
                    icon: 'warning',
                    title: 'Login Required',
                    text: 'Please login to book a trip.',
                    confirmButtonColor: '#2563eb'
                });
                return;
            }

            // Show loading state
            const loadingElement = document.getElementById('bookingLoading');
            const submitBtn = e.target.querySelector('button[type="submit"]');
            
            if (loadingElement) loadingElement.style.display = 'inline-block';
            submitBtn.disabled = true;
            
            const bookingData = {
                tripId: currentTripId,
                tripTitle: document.getElementById('modalTitle').textContent,
                tripLocation: document.getElementById('modalLocation').textContent,
                userId: currentUser.uid,
                userEmail: currentUser.email,
                name: document.getElementById('bookingName').value,
                email: document.getElementById('bookingEmail').value,
                phone: document.getElementById('bookingPhone').value,
                adults: parseInt(document.getElementById('adultCount').value),
                children: parseInt(document.getElementById('childCount').value),
                seniors: parseInt(document.getElementById('seniorCount').value),
                genderMix: document.getElementById('genderMix').value,
                preferredDate: document.getElementById('bookingDate').value,
                specialRequests: document.getElementById('specialRequests').value,
                bookingDate: firebase.firestore.FieldValue.serverTimestamp(),
                realtimeBookingDate: firebase.database.ServerValue.TIMESTAMP,
                status: 'pending',
                bookingId: 'BK' + Date.now() + Math.floor(Math.random() * 1000)
            };
            
            try {
                // Save to both Firestore and Realtime Database
                const firestorePromise = db.collection('bookings').add(bookingData);
                const realtimePromise = database.ref('bookings').push(bookingData);
                
                await Promise.all([firestorePromise, realtimePromise]);
                
                // Show success message with enhanced features
                showBookingSuccess(bookingData);
                
                // Reset form
                document.getElementById('bookingForm').reset();
                
                // Send notification
                sendFreeNotification('Booking Confirmed!', `Your booking ${bookingData.bookingId} has been submitted successfully.`);
                
            } catch (error) {
                console.error('Booking error:', error);
                Swal.fire({
                    icon: 'error',
                    title: 'Booking Failed',
                    text: 'Error submitting booking: ' + error.message,
                    confirmButtonColor: '#2563eb'
                });
            } finally {
                // Hide loading state
                if (loadingElement) loadingElement.style.display = 'none';
                submitBtn.disabled = false;
            }
        }

        function showBookingSuccess(bookingData) {
            const successHtml = `
                <div class="success-message" style="margin-bottom: 2rem;">
                    <i class="fas fa-check-circle"></i> 
                    Booking request submitted successfully! 
                    <br><strong>Booking ID: ${bookingData.bookingId}</strong>
                    <br>We will contact you soon.
                </div>
                
                <div class="booking-extras" style="background: #f0f7ff; padding: 1.5rem; border-radius: 15px; margin-bottom: 2rem;">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1rem;">
                        <div class="weather-info" style="background: white; padding: 1rem; border-radius: 10px;">
                            <h4><i class="fas fa-cloud-sun"></i> Weather Forecast</h4>
                            <p id="weatherInfo">Loading...</p>
                        </div>
                        <div class="currency-info" style="background: white; padding: 1rem; border-radius: 10px;">
                            <h4><i class="fas fa-money-bill-alt"></i> Currency Info</h4>
                            <p id="currencyInfo">Loading...</p>
                        </div>
                    </div>
                    
                    <div style="text-align: center; margin: 1rem 0;">
                        <img src="${generateBookingQR(bookingData.bookingId)}" alt="Booking QR Code" style="max-width: 120px; border-radius: 10px;">
                        <p style="margin: 0.5rem 0; color: #666; font-size: 0.9rem;">Scan QR code for booking details</p>
                    </div>
                    
                    <div style="display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap;">
                        <button class="btn btn-outline" onclick="printBookingDetails('${bookingData.bookingId}')" style="font-size: 0.9rem;">
                            <i class="fas fa-print"></i> Print Booking
                        </button>
                        <button class="btn btn-outline" onclick="speakText('Your booking ${bookingData.bookingId} has been confirmed. Thank you for choosing TrekWanders!')" style="font-size: 0.9rem;">
                            <i class="fas fa-volume-up"></i> Speak
                        </button>
                        <button class="btn btn-outline" onclick="shareBooking('${bookingData.bookingId}')" style="font-size: 0.9rem;">
                            <i class="fas fa-share"></i> Share
                        </button>
                    </div>
                </div>
            `;
            
            const bookingCard = document.querySelector('.booking-card');
            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = successHtml;
            bookingCard.insertBefore(tempDiv, document.getElementById('bookingForm'));
            
            // Load weather and currency info
            setTimeout(() => {
                const weather = getSimulatedWeather(currentTripLocation);
                document.getElementById('weatherInfo').innerHTML = `${weather.weather} • ${weather.temperature} • Humidity: ${weather.humidity}`;
                
                const currency = simulateCurrencyConversion(100, 'USD', 'EUR');
                document.getElementById('currencyInfo').innerHTML = `100 USD = ${currency.amount} ${currency.currency}`;
            }, 500);
            
            // Auto-remove after 15 seconds
            setTimeout(() => {
                if (tempDiv.parentNode) {
                    tempDiv.parentNode.removeChild(tempDiv);
                }
            }, 15000);
        }

        // Enhanced Review Submit (Fixed)
        async function handleReviewSubmit(e) {
            e.preventDefault();
            
            if (!currentUser) {
                Swal.fire({
                    icon: 'warning',
                    title: 'Login Required',
                    text: 'Please login to add a review.',
                    confirmButtonColor: '#2563eb'
                });
                return;
            }

            // Show loading state
            const loadingElement = document.getElementById('reviewLoading');
            const submitBtn = e.target.querySelector('button[type="submit"]');
            
            if (loadingElement) loadingElement.style.display = 'inline-block';
            submitBtn.disabled = true;
            
            const reviewData = {
                tripId: currentTripId,
                userId: currentUser.uid,
                userEmail: currentUser.email,
                userName: currentUser.displayName || currentUser.email.split('@')[0],
                rating: parseInt(document.getElementById('reviewRating').value),
                title: document.getElementById('reviewTitle').value,
                text: document.getElementById('reviewText').value,
                createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                realtimeCreatedAt: firebase.database.ServerValue.TIMESTAMP,
                likes: 0,
                helpful: 0
            };
            
            try {
                // Save to both Firestore and Realtime Database
                const firestorePromise = db.collection('reviews').add(reviewData);
                const realtimePromise = database.ref('reviews').push(reviewData);
                
                await Promise.all([firestorePromise, realtimePromise]);
                
                // Reset form and hide
                document.getElementById('reviewForm').reset();
                hideAddReviewForm();
                
                // Reload reviews
                loadTripReviews(currentTripId);
                
                // Show success notification
                Swal.fire({
                    icon: 'success',
                    title: 'Review Added!',
                    text: 'Your review has been posted successfully!',
                    confirmButtonColor: '#2563eb',
                    timer: 3000
                });
                
                sendFreeNotification('Review Added', 'Your review has been posted successfully!', 'success');
                
            } catch (error) {
                console.error('Error adding review:', error);
                Swal.fire({
                    icon: 'error',
                    title: 'Review Failed',
                    text: 'Failed to add review. Please try again.',
                    confirmButtonColor: '#2563eb'
                });
            } finally {
                // Hide loading state
                if (loadingElement) loadingElement.style.display = 'none';
                submitBtn.disabled = false;
            }
        }

        // Enhanced Feed Posts Rendering (3 per row, Material 3 Design)
        function renderFeedPosts(posts, reset = false) {
            const feedContainer = document.getElementById('feedPosts');
            
            if (reset) {
                feedContainer.innerHTML = '';
            }

            posts.forEach(post => {
                const postElement = createFeedPostElement(post);
                feedContainer.appendChild(postElement);
            });

            // Add load more button if not exists
            let loadMoreBtn = document.getElementById('loadMoreFeed');
            if (!loadMoreBtn) {
                loadMoreBtn = document.createElement('button');
                loadMoreBtn.id = 'loadMoreFeed';
                loadMoreBtn.className = 'btn btn-outline load-more-btn';
                loadMoreBtn.innerHTML = '<i class="fas fa-plus"></i> Load More Posts';
                loadMoreBtn.onclick = () => loadFeedPosts(false);
                loadMoreBtn.style.display = 'none';
                
                const feedSection = document.getElementById('feed');
                feedSection.appendChild(loadMoreBtn);
            }
        }

        // Share booking function
        function shareBooking(bookingId) {
            if (navigator.share) {
                navigator.share({
                    title: 'TrekWanders Booking',
                    text: `My booking confirmation: ${bookingId}`,
                    url: window.location.href
                });
            } else {
                // Fallback: copy to clipboard
                navigator.clipboard.writeText(`TrekWanders Booking: ${bookingId} - ${window.location.href}`);
                sendFreeNotification('Copied!', 'Booking details copied to clipboard', 'success');
            }
        }

        // Enhanced admin trip submission (Fixed)
        async function handleAdminSubmit(e) {
            e.preventDefault();
            
            if (!isAdmin) {
                Swal.fire({
                    icon: 'error',
                    title: 'Access Denied',
                    text: 'Admin privileges required.',
                    confirmButtonColor: '#2563eb'
                });
                return;
            }
            
            const loadingElement = document.getElementById('adminLoading');
            const submitTextElement = document.getElementById('adminSubmitText');
            
            if (loadingElement) loadingElement.style.display = 'inline-block';
            if (submitTextElement) submitTextElement.style.display = 'none';
            
            // Get images from both textarea and file uploads
            const textareaImages = document.getElementById('tripImages').value.split('\n').filter(url => url.trim());
            const uploadedImages = Array.from(document.querySelectorAll('#tripImagePreview img')).map(img => img.src);
            const allImages = [...textareaImages, ...uploadedImages].filter(url => url.trim());
            
            const requirements = document.getElementById('tripRequirements').value.split('\n').filter(req => req.trim());
            
                         const priceNumber = parseFloat(document.getElementById('tripPriceNumber').value);
             const priceFormatted = '$' + priceNumber.toLocaleString();
             
             const tripData = {
                 title: document.getElementById('tripTitle').value,
                 location: document.getElementById('tripLocation').value,
                 duration: document.getElementById('tripDuration').value,
                 images: allImages,
                 price: priceFormatted,
                 priceNumber: priceNumber,
                 difficulty: document.getElementById('tripDifficulty').value,
                 rating: parseFloat(document.getElementById('tripRating').value),
                 description: document.getElementById('tripDescription').value,
                 requirements: requirements,
                 videoUrl: document.getElementById('tripVideo').value,
                 category: document.getElementById('tripCategory').value,
                 section: document.getElementById('tripSection').value,
                 createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                 realtimeCreatedAt: firebase.database.ServerValue.TIMESTAMP,
                 createdBy: currentUser.email,
                 createdById: currentUser.uid
             };
            
            try {
                // Save to both Firestore and Realtime Database
                const firestorePromise = db.collection('trips').add(tripData);
                const realtimePromise = database.ref('trips').push(tripData);
                
                await Promise.all([firestorePromise, realtimePromise]);
                
                // Reset form and preview
                document.getElementById('adminForm').reset();
                document.getElementById('tripImagePreview').innerHTML = '';
                
                // Reload trips
                loadTripsFromFirestore();
                
                // Show success message
                Swal.fire({
                    icon: 'success',
                    title: 'Trip Added!',
                    text: 'Trip has been added successfully!',
                    confirmButtonColor: '#2563eb',
                    timer: 3000
                });
                
                sendFreeNotification('Success', 'Trip added successfully!', 'success');
                
            } catch (error) {
                console.error('Error adding trip:', error);
                Swal.fire({
                    icon: 'error',
                    title: 'Failed to Add Trip',
                    text: 'Error: ' + error.message,
                    confirmButtonColor: '#2563eb'
                });
            } finally {
                // Hide loading state
                                 if (loadingElement) loadingElement.style.display = 'none';
                 if (submitTextElement) submitTextElement.style.display = 'inline';
             }
         }

         // Advanced Search Filters
         function applyAdvancedFilters() {
             const searchTerm = document.getElementById('searchInput').value.toLowerCase();
             const minPrice = parseFloat(document.getElementById('minPrice').value) || 0;
             const maxPrice = parseFloat(document.getElementById('maxPrice').value) || Infinity;
             const durationFilter = document.getElementById('durationFilter').value;
             const difficultyFilter = document.getElementById('difficultyFilter').value;
             const ratingFilter = parseFloat(document.getElementById('ratingFilter').value) || 0;

             filteredTrips = allTrips.filter(trip => {
                 // Text search
                 const matchesSearch = !searchTerm || 
                     trip.title.toLowerCase().includes(searchTerm) ||
                     trip.location.toLowerCase().includes(searchTerm) ||
                     trip.category.toLowerCase().includes(searchTerm) ||
                     trip.description.toLowerCase().includes(searchTerm);

                 // Price filter
                 const tripPrice = trip.priceNumber || 0;
                 const matchesPrice = tripPrice >= minPrice && tripPrice <= maxPrice;

                 // Duration filter
                 let matchesDuration = true;
                 if (durationFilter) {
                     const duration = trip.duration || '';
                     const days = parseInt(duration.match(/\d+/)) || 0;
                     
                     switch(durationFilter) {
                         case '1-3':
                             matchesDuration = days >= 1 && days <= 3;
                             break;
                         case '4-7':
                             matchesDuration = days >= 4 && days <= 7;
                             break;
                         case '8-14':
                             matchesDuration = days >= 8 && days <= 14;
                             break;
                         case '15+':
                             matchesDuration = days >= 15;
                             break;
                     }
                 }

                 // Difficulty filter
                 const matchesDifficulty = !difficultyFilter || trip.difficulty === difficultyFilter;

                 // Rating filter
                 const matchesRating = trip.rating >= ratingFilter;

                 return matchesSearch && matchesPrice && matchesDuration && matchesDifficulty && matchesRating;
             });

             renderTrips();
             
             const resultsCount = filteredTrips.length;
             sendFreeNotification('Search Results', `Found ${resultsCount} trips matching your criteria`, 'info');
         }

         function clearAllFilters() {
             document.getElementById('searchInput').value = '';
             document.getElementById('minPrice').value = '';
             document.getElementById('maxPrice').value = '';
             document.getElementById('durationFilter').value = '';
             document.getElementById('difficultyFilter').value = '';
             document.getElementById('ratingFilter').value = '';
             
             // Reset category filter
             document.querySelectorAll('.category-btn').forEach(btn => btn.classList.remove('active'));
             document.querySelector('.category-btn[data-category="all"]').classList.add('active');
             
             filteredTrips = [...allTrips];
             renderTrips();
             
             sendFreeNotification('Filters Cleared', 'All filters have been reset', 'info');
         }

         // Post Rating System
         async function ratePost(postId, rating) {
             if (!currentUser) {
                 Swal.fire({
                     icon: 'warning',
                     title: 'Login Required',
                     text: 'Please login to rate posts.',
                     confirmButtonColor: '#2563eb'
                 });
                 return;
             }

             try {
                 // Update user's rating for this post
                 await database.ref(`postRatings/${postId}/${currentUser.uid}`).set({
                     rating: rating,
                     userId: currentUser.uid,
                     userEmail: currentUser.email,
                     timestamp: firebase.database.ServerValue.TIMESTAMP
                 });

                 // Update the visual rating
                 const starRating = document.querySelector(`[data-post-id="${postId}"]`);
                 if (starRating) {
                     const stars = starRating.querySelectorAll('.star');
                     stars.forEach((star, index) => {
                         star.classList.toggle('active', index < rating);
                     });
                 }

                 // Calculate and update average rating
                 const ratingsSnapshot = await database.ref(`postRatings/${postId}`).once('value');
                 const ratings = ratingsSnapshot.val() || {};
                 const ratingValues = Object.values(ratings).map(r => r.rating);
                 const averageRating = ratingValues.reduce((a, b) => a + b, 0) / ratingValues.length;
                 const totalRatings = ratingValues.length;

                 // Update post with new average rating
                 await database.ref(`feed/${postId}`).update({
                     averageRating: averageRating,
                     totalRatings: totalRatings
                 });

                 sendFreeNotification('Rating Submitted', `You rated this post ${rating} stars!`, 'success');
                 
                 // Reload feed to show updated ratings
                 setTimeout(() => {
                     if (isAdmin) {
                         loadFeedPosts();
                     } else {
                         loadSampleFeedPosts();
                     }
                 }, 1000);

             } catch (error) {
                 console.error('Error rating post:', error);
                 sendFreeNotification('Error', 'Failed to submit rating', 'error');
             }
         }

         // Enhanced filter event listeners
         document.addEventListener('DOMContentLoaded', function() {
             // Add filter event listeners
             document.getElementById('minPrice').addEventListener('input', debounce(applyAdvancedFilters, 500));
             document.getElementById('maxPrice').addEventListener('input', debounce(applyAdvancedFilters, 500));
             document.getElementById('durationFilter').addEventListener('change', applyAdvancedFilters);
             document.getElementById('difficultyFilter').addEventListener('change', applyAdvancedFilters);
             document.getElementById('ratingFilter').addEventListener('change', applyAdvancedFilters);
         });

         // Debounce function for performance
         function debounce(func, wait) {
             let timeout;
             return function executedFunction(...args) {
                 const later = () => {
                     clearTimeout(timeout);
                     func(...args);
                 };
                 clearTimeout(timeout);
                               timeout = setTimeout(later, wait);
          };
      }

      // Real-time Analytics Dashboard
      async function loadAnalyticsDashboard() {
          if (!isAdmin) return;
          
          try {
              // Update statistics
              await updateDashboardStats();
              
              // Load charts
              loadCategoryChart();
              loadRatingChart();
              loadTrendChart();
              loadRecentBookings();
              
          } catch (error) {
              console.error('Error loading analytics:', error);
          }
      }

      async function updateDashboardStats() {
          try {
              // Count users
              const usersSnapshot = await database.ref('users').once('value');
              const usersCount = usersSnapshot.numChildren();
              document.getElementById('totalUsers').textContent = usersCount;

              // Count bookings
              const bookingsSnapshot = await database.ref('bookings').once('value');
              const bookingsCount = bookingsSnapshot.numChildren();
              document.getElementById('totalBookings').textContent = bookingsCount;

              // Count trips
              document.getElementById('totalTrips').textContent = allTrips.length;

              // Calculate revenue (simulated)
              let totalRevenue = 0;
              if (bookingsSnapshot.exists()) {
                  bookingsSnapshot.forEach(child => {
                      const booking = child.val();
                      // Simulate revenue calculation
                      totalRevenue += Math.floor(Math.random() * 2000) + 500;
                  });
              }
              document.getElementById('totalRevenue').textContent = '$' + totalRevenue.toLocaleString();

          } catch (error) {
              console.error('Error updating dashboard stats:', error);
          }
      }

      function loadCategoryChart() {
          const ctx = document.getElementById('categoryChart').getContext('2d');
          
          // Count trips by category
          const categoryCount = {};
          allTrips.forEach(trip => {
              categoryCount[trip.category] = (categoryCount[trip.category] || 0) + 1;
          });

          new Chart(ctx, {
              type: 'doughnut',
              data: {
                  labels: Object.keys(categoryCount),
                  datasets: [{
                      data: Object.values(categoryCount),
                      backgroundColor: [
                          '#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0',
                          '#9966FF', '#FF9F40', '#FF6384', '#C9CBCF'
                      ]
                  }]
              },
              options: {
                  responsive: true,
                  plugins: {
                      legend: {
                          position: 'bottom'
                      }
                  }
              }
          });
      }

      function loadRatingChart() {
          const ctx = document.getElementById('ratingChart').getContext('2d');
          
          // Count trips by rating range
          const ratingRanges = {
              '5.0': 0, '4.5-4.9': 0, '4.0-4.4': 0, '3.5-3.9': 0, '3.0-3.4': 0, 'Below 3.0': 0
          };
          
          allTrips.forEach(trip => {
              const rating = trip.rating;
              if (rating === 5.0) ratingRanges['5.0']++;
              else if (rating >= 4.5) ratingRanges['4.5-4.9']++;
              else if (rating >= 4.0) ratingRanges['4.0-4.4']++;
              else if (rating >= 3.5) ratingRanges['3.5-3.9']++;
              else if (rating >= 3.0) ratingRanges['3.0-3.4']++;
              else ratingRanges['Below 3.0']++;
          });

          new Chart(ctx, {
              type: 'bar',
              data: {
                  labels: Object.keys(ratingRanges),
                  datasets: [{
                      label: 'Number of Trips',
                      data: Object.values(ratingRanges),
                      backgroundColor: '#36A2EB',
                      borderColor: '#1E88E5',
                      borderWidth: 1
                  }]
              },
              options: {
                  responsive: true,
                  scales: {
                      y: {
                          beginAtZero: true
                      }
                  }
              }
          });
      }

      function loadTrendChart() {
          const ctx = document.getElementById('trendChart').getContext('2d');
          
          // Simulate booking trends over last 7 days
          const days = [];
          const bookings = [];
          
          for (let i = 6; i >= 0; i--) {
              const date = new Date();
              date.setDate(date.getDate() - i);
              days.push(date.toLocaleDateString('en-US', { weekday: 'short' }));
              bookings.push(Math.floor(Math.random() * 20) + 5);
          }

          new Chart(ctx, {
              type: 'line',
              data: {
                  labels: days,
                  datasets: [{
                      label: 'Daily Bookings',
                      data: bookings,
                      borderColor: '#4BC0C0',
                      backgroundColor: 'rgba(75, 192, 192, 0.1)',
                      tension: 0.4,
                      fill: true
                  }]
              },
              options: {
                  responsive: true,
                  scales: {
                      y: {
                          beginAtZero: true
                      }
                  }
              }
          });
      }

      async function loadRecentBookings() {
          try {
              const bookingsSnapshot = await database.ref('bookings').limitToLast(5).once('value');
              const recentBookingsDiv = document.getElementById('recentBookings');
              
              if (bookingsSnapshot.exists()) {
                  recentBookingsDiv.innerHTML = '';
                  const bookings = [];
                  
                  bookingsSnapshot.forEach(child => {
                      bookings.unshift({ id: child.key, ...child.val() });
                  });

                  bookings.forEach(booking => {
                      const bookingDiv = document.createElement('div');
                      bookingDiv.style.cssText = 'padding: 0.8rem; border-bottom: 1px solid #e5e7eb; display: flex; justify-content: space-between; align-items: center;';
                      
                      const date = booking.realtimeBookingDate ? 
                          new Date(booking.realtimeBookingDate).toLocaleDateString() : 
                          'Recent';
                      
                      bookingDiv.innerHTML = `
                          <div>
                              <div style="font-weight: 500;">${booking.name}</div>
                              <div style="font-size: 0.8rem; color: #666;">${booking.tripTitle || 'Trip Booking'}</div>
                          </div>
                          <div style="text-align: right;">
                              <div style="font-size: 0.8rem; color: #666;">${date}</div>
                              <div style="font-size: 0.8rem; padding: 0.2rem 0.5rem; background: #10b981; color: white; border-radius: 10px;">
                                  ${booking.status || 'Pending'}
                              </div>
                          </div>
                      `;
                      
                      recentBookingsDiv.appendChild(bookingDiv);
                  });
              }
          } catch (error) {
              console.error('Error loading recent bookings:', error);
          }
      }

      // Booking Management Functions
      async function loadAllBookings() {
          if (!isAdmin) return;
          
          try {
              const bookingsSnapshot = await database.ref('bookings').once('value');
              const bookingsGrid = document.getElementById('bookingsGrid');
              bookingsGrid.innerHTML = '';
              
              if (bookingsSnapshot.exists()) {
                  const bookings = [];
                  bookingsSnapshot.forEach(child => {
                      bookings.push({ id: child.key, ...child.val() });
                  });
                  
                  // Sort by date (newest first)
                  bookings.sort((a, b) => (b.realtimeBookingDate || 0) - (a.realtimeBookingDate || 0));
                  
                  bookings.forEach((booking, index) => {
                      const bookingCard = createBookingCard(booking, true, index >= 4);
                      bookingsGrid.appendChild(bookingCard);
                  });
                  
                  // Add view more button if more than 4 bookings
                  if (bookings.length > 4) {
                      const viewMoreBtn = document.createElement('div');
                      viewMoreBtn.className = 'view-more-bookings';
                      viewMoreBtn.innerHTML = `
                          <button class="btn btn-primary" onclick="showAllBookings()">
                              <i class="fas fa-eye"></i> View All ${bookings.length} Bookings
                          </button>
                      `;
                      bookingsGrid.appendChild(viewMoreBtn);
                  }
              } else {
                  bookingsGrid.innerHTML = `
                      <div style="grid-column: 1 / -1; text-align: center; padding: 3rem; color: #666;">
                          <i class="fas fa-calendar-alt" style="font-size: 4rem; margin-bottom: 1rem; opacity: 0.3;"></i>
                          <h3>No bookings yet</h3>
                          <p>Bookings will appear here when users make reservations</p>
                      </div>
                  `;
              }
          } catch (error) {
              console.error('Error loading admin bookings:', error);
          }
      }

      async function loadUserBookings() {
          if (!currentUser) return;
          
          try {
              const bookingsSnapshot = await database.ref('bookings')
                  .orderByChild('userId')
                  .equalTo(currentUser.uid)
                  .once('value');
              
              const userBookingsGrid = document.getElementById('userBookingsGrid');
              userBookingsGrid.innerHTML = '';
              
              if (bookingsSnapshot.exists()) {
                  const bookings = [];
                  bookingsSnapshot.forEach(child => {
                      bookings.push({ id: child.key, ...child.val() });
                  });
                  
                  // Sort by date (newest first)
                  bookings.sort((a, b) => (b.realtimeBookingDate || 0) - (a.realtimeBookingDate || 0));
                  
                  bookings.forEach(booking => {
                      const bookingCard = createBookingCard(booking, false);
                      userBookingsGrid.appendChild(bookingCard);
                  });
              } else {
                  userBookingsGrid.innerHTML = `
                      <div style="grid-column: 1 / -1; text-align: center; padding: 3rem; color: #666;">
                          <i class="fas fa-suitcase-rolling" style="font-size: 4rem; margin-bottom: 1rem; opacity: 0.3;"></i>
                          <h3>No bookings yet</h3>
                          <p>Your travel bookings will appear here. <a href="#destinations" style="color: #2563eb;">Browse destinations</a> to start your journey!</p>
                      </div>
                  `;
              }
          } catch (error) {
              console.error('Error loading user bookings:', error);
          }
      }

      function createBookingCard(booking, isAdmin = false, isBlurred = false) {
          const card = document.createElement('div');
          card.className = `booking-card-item ${isBlurred ? 'blurred' : ''}`;
          
          const date = booking.realtimeBookingDate ? 
              new Date(booking.realtimeBookingDate).toLocaleDateString() : 
              'Recent';
          
          const statusClass = `status-${booking.status || 'pending'}`;
          
          card.innerHTML = `
              <div class="booking-header">
                  <div class="booking-id">${booking.bookingId || 'N/A'}</div>
                  <div class="booking-status ${statusClass}">${booking.status || 'pending'}</div>
              </div>
              
              <div class="booking-details">
                  <div class="booking-detail-row">
                      <strong>Customer:</strong>
                      <span>${booking.name}</span>
                  </div>
                  <div class="booking-detail-row">
                      <strong>Trip:</strong>
                      <span>${booking.tripTitle || 'N/A'}</span>
                  </div>
                  <div class="booking-detail-row">
                      <strong>Location:</strong>
                      <span>${booking.tripLocation || 'N/A'}</span>
                  </div>
                  <div class="booking-detail-row">
                      <strong>Date:</strong>
                      <span>${booking.preferredDate || date}</span>
                  </div>
                  <div class="booking-detail-row">
                      <strong>Travelers:</strong>
                      <span>${(booking.adults || 1)} Adults, ${(booking.children || 0)} Children</span>
                  </div>
                  <div class="booking-detail-row">
                      <strong>Contact:</strong>
                      <span>${booking.email}</span>
                  </div>
              </div>
              
              ${isAdmin ? `
              <div class="booking-actions">
                  <select class="status-selector" onchange="updateBookingStatus('${booking.id}', this.value)" value="${booking.status || 'pending'}">
                      <option value="pending" ${(booking.status || 'pending') === 'pending' ? 'selected' : ''}>Pending</option>
                      <option value="confirmed" ${booking.status === 'confirmed' ? 'selected' : ''}>Confirmed</option>
                      <option value="cancelled" ${booking.status === 'cancelled' ? 'selected' : ''}>Cancelled</option>
                      <option value="completed" ${booking.status === 'completed' ? 'selected' : ''}>Completed</option>
                  </select>
                  <button class="btn btn-outline" onclick="viewBookingDetails('${booking.id}')" style="font-size: 0.8rem; padding: 0.4rem 0.8rem;">
                      <i class="fas fa-eye"></i> View
                  </button>
              </div>
              ` : ''}
          `;
          
          return card;
      }

      async function updateBookingStatus(bookingId, newStatus) {
          if (!isAdmin) return;
          
          try {
              await database.ref(`bookings/${bookingId}/status`).set(newStatus);
              await database.ref(`bookings/${bookingId}/updatedAt`).set(firebase.database.ServerValue.TIMESTAMP);
              
              sendFreeNotification('Status Updated', `Booking status changed to ${newStatus}`, 'success');
              
              // Reload bookings
              loadAllBookings();
              
          } catch (error) {
              console.error('Error updating booking status:', error);
              sendFreeNotification('Error', 'Failed to update booking status', 'error');
          }
      }

      function showAllBookings() {
          document.querySelectorAll('.booking-card-item').forEach(card => {
              card.classList.remove('blurred');
              card.style.filter = 'none';
              card.style.opacity = '1';
              card.style.pointerEvents = 'auto';
          });
          
          document.querySelector('.view-more-bookings').style.display = 'none';
      }

      // Smart Search Suggestions
      function showSmartSuggestions(searchTerm) {
          const suggestionsDiv = document.getElementById('smartSuggestions');
          const suggestionsList = document.getElementById('suggestionsList');
          
          if (!searchTerm || searchTerm.length < 2) {
              suggestionsDiv.style.display = 'none';
              return;
          }
          
          // Generate smart suggestions based on available trips
          const suggestions = [];
          
          // Location-based suggestions
          const locations = [...new Set(allTrips.map(trip => trip.location))];
          locations.forEach(location => {
              if (location.toLowerCase().includes(searchTerm.toLowerCase())) {
                  suggestions.push({
                      type: 'location',
                      text: location,
                      icon: '📍',
                      action: () => applyLocationFilter(location)
                  });
              }
          });
          
          // Category suggestions
          const categories = ['adventure', 'beach', 'mountain', 'cultural', 'wildlife'];
          categories.forEach(category => {
              if (category.toLowerCase().includes(searchTerm.toLowerCase())) {
                  const icons = { adventure: '🏔️', beach: '🏖️', mountain: '⛰️', cultural: '🏛️', wildlife: '🦁' };
                  suggestions.push({
                      type: 'category',
                      text: category.charAt(0).toUpperCase() + category.slice(1),
                      icon: icons[category],
                      action: () => applyCategoryFilter(category)
                  });
              }
          });
          
          // Trip name suggestions
          allTrips.forEach(trip => {
              if (trip.title.toLowerCase().includes(searchTerm.toLowerCase())) {
                  suggestions.push({
                      type: 'trip',
                      text: trip.title,
                      icon: '✈️',
                      action: () => openTripModal(trip)
                  });
              }
          });
          
          // Difficulty suggestions
          const difficulties = ['easy', 'moderate', 'challenging', 'extreme'];
          difficulties.forEach(difficulty => {
              if (difficulty.toLowerCase().includes(searchTerm.toLowerCase())) {
                  suggestions.push({
                      type: 'difficulty',
                      text: `${difficulty.charAt(0).toUpperCase() + difficulty.slice(1)} Level`,
                      icon: '⚡',
                      action: () => applyDifficultyFilter(difficulty)
                  });
              }
          });
          
          // Show suggestions
          if (suggestions.length > 0) {
              suggestionsList.innerHTML = suggestions.slice(0, 5).map(suggestion => `
                  <div class="suggestion-item" onclick="selectSuggestion('${suggestion.type}', '${suggestion.text}', '${suggestion.action}')">
                      <span>${suggestion.icon}</span>
                      <span>${suggestion.text}</span>
                      <small style="opacity: 0.7;">${suggestion.type}</small>
                  </div>
              `).join('');
              suggestionsDiv.style.display = 'block';
          } else {
              suggestionsDiv.style.display = 'none';
          }
      }

      function selectSuggestion(type, text, actionStr) {
          document.getElementById('searchInput').value = text;
          document.getElementById('smartSuggestions').style.display = 'none';
          
          // Apply the filter based on type
          if (type === 'location') applyLocationFilter(text);
          else if (type === 'category') applyCategoryFilter(text.toLowerCase());
          else if (type === 'difficulty') applyDifficultyFilter(text.split(' ')[0].toLowerCase());
          else if (type === 'trip') {
              const trip = allTrips.find(t => t.title === text);
              if (trip) openTripModal(trip);
          }
      }

      function applyLocationFilter(location) {
          filteredTrips = allTrips.filter(trip => trip.location.includes(location));
          renderTrips();
          sendFreeNotification('Filter Applied', `Showing trips in ${location}`, 'info');
      }

      function applyCategoryFilter(category) {
          // Update category buttons
          document.querySelectorAll('.category-btn').forEach(btn => btn.classList.remove('active'));
          document.querySelector(`[data-category="${category}"]`).classList.add('active');
          
          filteredTrips = category === 'all' ? [...allTrips] : allTrips.filter(trip => trip.category === category);
          renderTrips();
      }

      function applyDifficultyFilter(difficulty) {
          document.getElementById('difficultyFilter').value = difficulty;
          applyAdvancedFilters();
      }

      // Enhanced Feed Post Creation
      async function handleFeedPostSubmit(e) {
          e.preventDefault();
          
          if (!isAdmin) {
              alert('Only admins can create posts.');
              return;
          }

          let imageUrl = document.getElementById('postImage').value;
          const videoUrl = document.getElementById('postVideo').value;
          
          // Handle image upload
          const imageFile = document.getElementById('postImageFile').files[0];
          if (imageFile) {
              try {
                  imageUrl = await uploadToFreeService(imageFile);
              } catch (error) {
                  console.error('Error uploading image:', error);
              }
          }
          
          // Convert YouTube URL to embed format
          let embedVideoUrl = '';
          if (videoUrl) {
              const videoId = extractYouTubeVideoId(videoUrl);
              if (videoId) {
                  embedVideoUrl = `https://www.youtube.com/embed/${videoId}`;
              }
          }

          const postData = {
              title: document.getElementById('postTitle').value,
              content: document.getElementById('postContent').value,
              imageUrl: imageUrl,
              videoUrl: embedVideoUrl,
              authorName: currentUser.displayName || currentUser.email.split('@')[0],
              authorEmail: currentUser.email,
              authorId: currentUser.uid,
              createdAt: firebase.firestore.FieldValue.serverTimestamp(),
              realtimeCreatedAt: firebase.database.ServerValue.TIMESTAMP,
              likes: 0,
              averageRating: 0,
              totalRatings: 0
          };

          try {
              // Save to both databases for real-time updates
              const docRef = await db.collection('feed').add(postData);
              await database.ref('feed/' + docRef.id).set({
                  ...postData,
                  id: docRef.id,
                  createdAt: firebase.database.ServerValue.TIMESTAMP
              });
              
              document.getElementById('feedPostForm').reset();
              document.getElementById('postImagePreview').innerHTML = '';
              hideAddPostForm();
              
              // Real-time reload
              loadFeedPosts();
              
              sendFreeNotification('Success', 'Post created successfully!', 'success');
              
          } catch (error) {
              console.error('Error creating post:', error);
              sendFreeNotification('Error', 'Failed to create post: ' + error.message, 'error');
          }
      }

      function extractYouTubeVideoId(url) {
          const regex = /(?:youtube\.com\/(?:[^\/]+\/.+\/|(?:v|e(?:mbed)?)\/|.*[?&]v=)|youtu\.be\/)([^"&?\/\s]{11})/;
          const match = url.match(regex);
          return match ? match[1] : null;
      }

      // Enhanced Feed Post Display
      function createFeedPostElement(post) {
          const postDiv = document.createElement('div');
          postDiv.className = 'feed-post';
          
          const createdDate = post.createdAt instanceof Date ? post.createdAt : (post.createdAt ? post.createdAt.toDate() : new Date());
          const timeAgo = getTimeAgo(createdDate);
          const currentRating = post.userRating || 0;
          const averageRating = post.averageRating || 0;
          const totalRatings = post.totalRatings || 0;

          postDiv.innerHTML = `
              <div class="post-header">
                  <div class="post-avatar">${post.authorName[0].toUpperCase()}</div>
                  <div class="post-info">
                      <h4>${post.authorName}</h4>
                      <div class="post-date">${timeAgo}</div>
                  </div>
                  ${isAdmin ? `
                  <div class="admin-actions">
                      <button class="admin-btn" onclick="editFeedPost('${post.id}')" title="Edit Post">
                          <i class="fas fa-edit"></i>
                      </button>
                      <button class="admin-btn" onclick="deleteFeedPost('${post.id}')" title="Delete Post">
                          <i class="fas fa-trash"></i>
                      </button>
                  </div>
                  ` : ''}
              </div>
              <div class="post-content">
                  <h3>${post.title}</h3>
                  <p>${post.content}</p>
                  ${post.imageUrl ? `<img src="${post.imageUrl}" alt="Post image" class="post-image">` : ''}
                  ${post.videoUrl ? `
                      <div class="video-container" style="margin: 1rem 0;">
                          <iframe src="${post.videoUrl}" frameborder="0" allowfullscreen style="width: 100%; height: 300px; border-radius: 10px;"></iframe>
                      </div>
                  ` : ''}
              </div>
              <div class="post-rating">
                  <div class="rating-section">
                      <span style="margin-right: 1rem;">Rate this post:</span>
                      <div class="star-rating" data-post-id="${post.id}">
                          ${[1,2,3,4,5].map(star => `
                              <span class="star ${star <= currentRating ? 'active' : ''}" 
                                    onclick="ratePost('${post.id}', ${star})">★</span>
                          `).join('')}
                      </div>
                  </div>
                  <div class="rating-display">
                      <span class="rating-stats">
                          ${averageRating > 0 ? `${averageRating.toFixed(1)} ★ (${totalRatings} ratings)` : 'No ratings yet'}
                      </span>
                  </div>
              </div>
          `;

          return postDiv;
      }

      // Image upload for posts
      document.addEventListener('DOMContentLoaded', function() {
          document.getElementById('postImageFile').addEventListener('change', async function(e) {
              const file = e.target.files[0];
              if (!file) return;
              
              try {
                  const preview = document.getElementById('postImagePreview');
                  preview.innerHTML = '<div class="loading"></div> Uploading...';
                  
                  const url = await uploadToFreeService(file);
                  document.getElementById('postImage').value = url;
                  
                  preview.innerHTML = `<img src="${url}" style="max-width: 200px; border-radius: 10px;">`;
              } catch (error) {
                  console.error('Error uploading post image:', error);
                  document.getElementById('postImagePreview').innerHTML = '';
              }
          });
      });
    </script>

    <!-- Footer Section -->
    <footer id="footer" class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <div class="footer-logo">
                        <h3><i class="fas fa-mountain"></i> TrekWanders</h3>
                        <p>Experience the magic of travel with our curated adventures around the world.</p>
                    </div>
                </div>
                
                <div class="footer-section">
                    <h4><i class="fas fa-map-marker-alt"></i> Contact Info</h4>
                    <div class="contact-info" id="contactInfo">
                        <p><i class="fas fa-envelope"></i> <span id="contactEmail">info@trekwanders.com</span></p>
                        <p><i class="fas fa-phone"></i> <span id="contactPhone">+91 98765 43210</span></p>
                        <p><i class="fas fa-map-pin"></i> <span id="contactAddress">Mumbai, Maharashtra, India</span></p>
                    </div>
                </div>
                
                <div class="footer-section">
                    <h4><i class="fas fa-link"></i> Quick Links</h4>
                    <ul class="footer-links">
                        <li><a href="#trending"><i class="fas fa-fire"></i> Trending</a></li>
                        <li><a href="#ongoing"><i class="fas fa-compass"></i> Ongoing</a></li>
                        <li><a href="#upcoming"><i class="fas fa-calendar"></i> Upcoming</a></li>
                        <li><a href="#feed"><i class="fas fa-rss"></i> Feed</a></li>
                    </ul>
                </div>
                
                <div class="footer-section">
                    <h4><i class="fas fa-share-alt"></i> Follow Us</h4>
                    <div class="social-links" id="socialLinks">
                        <a href="#" id="facebookLink" target="_blank"><i class="fab fa-facebook-f"></i></a>
                        <a href="#" id="twitterLink" target="_blank"><i class="fab fa-twitter"></i></a>
                        <a href="#" id="instagramLink" target="_blank"><i class="fab fa-instagram"></i></a>
                        <a href="#" id="linkedinLink" target="_blank"><i class="fab fa-linkedin-in"></i></a>
                        <a href="#" id="youtubeLink" target="_blank"><i class="fab fa-youtube"></i></a>
                    </div>
                </div>
            </div>
            
            <div class="footer-bottom">
                <div class="footer-bottom-content">
                    <p>&copy; 2024 TrekWanders. All rights reserved.</p>
                    <div class="footer-bottom-links">
                        <a href="#"><i class="fas fa-shield-alt"></i> Privacy Policy</a>
                        <a href="#"><i class="fas fa-file-contract"></i> Terms of Service</a>
                        <a href="#"><i class="fas fa-cookie-bite"></i> Cookie Policy</a>
                    </div>
                </div>
            </div>
        </div>
    </footer>
</body>
</html>